[1/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/general_kernels.cu -o general_kernels.cuda.o 
[2/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/transform_kernels_new.cu -o transform_kernels_new.cuda.o 
[3/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/cublas_wrappers.cu -o cublas_wrappers.cuda.o 
[4/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/transform_kernels.cu -o transform_kernels.cuda.o 
[5/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/embedding_kernels.cu -o embedding_kernels.cuda.o 
[6/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/normalize_kernels.cu -o normalize_kernels.cuda.o 
[7/38] c++ -MMD -MF layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/layer.cpp -o layer.o 
[8/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu -o dropout_kernels.cuda.o 
/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1509): warning: variable "thread_cmax_out_grad" was declared but never referenced
          detected during instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const int8_t *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t, __nv_bool) [with act_type=ActivationType::kRelu, T=float]" 
(1601): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1513): warning: variable "temp_cmax_out_grad" was declared but never referenced
          detected during instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const int8_t *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t, __nv_bool) [with act_type=ActivationType::kRelu, T=float]" 
(1601): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1545): warning: variable "block_cmax_out_grad" was declared but never referenced
          detected during instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const int8_t *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t, __nv_bool) [with act_type=ActivationType::kRelu, T=float]" 
(1601): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1667): warning: variable "cmax_in_val" was declared but never referenced
          detected during:
            instantiation of "void ls_quant_dropout_act_bias_bwd_kernel<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, float, int) [with act_type=ActivationType::kRelu, T=float]" 
(1751): here
            instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t) [with act_type=ActivationType::kRelu, T=float]" 
(1754): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1667): warning: variable "cmax_in_val" was declared but never referenced
          detected during:
            instantiation of "void ls_quant_dropout_act_bias_bwd_kernel<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, float, int) [with act_type=ActivationType::kGelu, T=float]" 
(1751): here
            instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t) [with act_type=ActivationType::kGelu, T=float]" 
(1770): here

[9/38] c++ -MMD -MF node.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/node.cpp -o node.o 
[10/38] c++ -MMD -MF context.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/context.cpp -o context.o 
[11/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/crf.cu -o crf.cuda.o 
[12/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/softmax_kernels.cu -o softmax_kernels.cuda.o 
[13/38] c++ -MMD -MF manager.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/manager.cpp -o manager.o 
[14/38] c++ -MMD -MF tensor.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/tensor.cpp -o tensor.o 
[15/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/softmax_kernels_new.cu -o softmax_kernels_new.cuda.o 
[16/38] c++ -MMD -MF bias_dropout_residual.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/bias_dropout_residual.cpp -o bias_dropout_residual.o 
[17/38] c++ -MMD -MF bias_act_dropout.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/bias_act_dropout.cpp -o bias_act_dropout.o 
[18/38] c++ -MMD -MF linear.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/linear.cpp -o linear.o 
[19/38] c++ -MMD -MF layer_normalize.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/layer_normalize.cpp -o layer_normalize.o 
[20/38] c++ -MMD -MF strided_batch_gemm.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/strided_batch_gemm.cpp -o strided_batch_gemm.o 
[21/38] c++ -MMD -MF bias_add_transform_20314.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/bias_add_transform_20314.cpp -o bias_add_transform_20314.o 
[22/38] c++ -MMD -MF softmax.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/softmax.cpp -o softmax.o 
[23/38] c++ -MMD -MF dropout.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/dropout.cpp -o dropout.o 
[24/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/cross_entropy.cu -o cross_entropy.cuda.o 
[25/38] c++ -MMD -MF launch_concat3_dim1.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/launch_concat3_dim1.cpp -o launch_concat3_dim1.o 
[26/38] c++ -MMD -MF transform_0213.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/transform_0213.cpp -o transform_0213.o 
[27/38] c++ -MMD -MF crf.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/crf.cpp -o crf.o 
[28/38] c++ -MMD -MF transformer_encoder_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/transformer_encoder_layer.cpp -o transformer_encoder_layer.o 
[29/38] c++ -MMD -MF feed_forward_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/feed_forward_layer.cpp -o feed_forward_layer.o 
[30/38] c++ -MMD -MF multihead_attention_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/multihead_attention_layer.cpp -o multihead_attention_layer.o 
[31/38] c++ -MMD -MF encdec_kv_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/encdec_kv_layer.cpp -o encdec_kv_layer.o 
[32/38] c++ -MMD -MF crf_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/crf_layer.cpp -o crf_layer.o 
[33/38] c++ -MMD -MF transformer_decoder_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/transformer_decoder_layer.cpp -o transformer_decoder_layer.o 
[34/38] c++ -MMD -MF dec_self_attention_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/dec_self_attention_layer.cpp -o dec_self_attention_layer.o 
[35/38] c++ -MMD -MF dec_enc_attention_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/dec_enc_attention_layer.cpp -o dec_enc_attention_layer.o 
[36/38] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/cuda_util.cu -o cuda_util.cuda.o 
[37/38] c++ -MMD -MF pybind_layer_new.o.d -DTORCH_EXTENSION_NAME=lightseq_layers_new -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops_new/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/lsflow/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers_new/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -DPYBIND_LAYER -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/pybind/pybind_layer_new.cpp -o pybind_layer_new.o 
[38/38] c++ cublas_wrappers.cuda.o transform_kernels.cuda.o transform_kernels_new.cuda.o dropout_kernels.cuda.o normalize_kernels.cuda.o softmax_kernels.cuda.o softmax_kernels_new.cuda.o general_kernels.cuda.o cuda_util.cuda.o embedding_kernels.cuda.o cross_entropy.cuda.o crf.cuda.o context.o layer.o manager.o node.o tensor.o bias_act_dropout.o bias_dropout_residual.o linear.o layer_normalize.o strided_batch_gemm.o bias_add_transform_20314.o dropout.o softmax.o launch_concat3_dim1.o transform_0213.o crf.o feed_forward_layer.o multihead_attention_layer.o transformer_encoder_layer.o dec_self_attention_layer.o encdec_kv_layer.o dec_enc_attention_layer.o transformer_decoder_layer.o crf_layer.o pybind_layer_new.o -shared -L/opt/conda/lib/python3.7/site-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda_cu -ltorch_cuda_cpp -ltorch -ltorch_python -L/usr/local/cuda/lib64 -lcudart -o lightseq_layers_new.so
Time to load lightseq_layers_new op: 51.43835735321045 seconds
[1/18] c++ -MMD -MF cublas_wrappers.o.d -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/cublas_wrappers.cpp -o cublas_wrappers.o 
[2/18] c++ -MMD -MF cublas_algo_map.o.d -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/cublas_algo_map.cpp -o cublas_algo_map.o 
[3/18] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/general_kernels.cu -o general_kernels.cuda.o 
[4/18] c++ -MMD -MF cross_entropy_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/cross_entropy_layer.cpp -o cross_entropy_layer.o 
[5/18] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/quantize_kernels.cu -o quantize_kernels.cuda.o 
[6/18] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/transform_kernels.cu -o transform_kernels.cuda.o 
[7/18] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/embedding_kernels.cu -o embedding_kernels.cuda.o 
[8/18] c++ -MMD -MF quant_linear_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/quant_linear_layer.cpp -o quant_linear_layer.o 
[9/18] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/normalize_kernels.cu -o normalize_kernels.cuda.o 
[10/18] c++ -MMD -MF transformer_embedding_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/transformer_embedding_layer.cpp -o transformer_embedding_layer.o 
[11/18] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu -o dropout_kernels.cuda.o 
/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1509): warning: variable "thread_cmax_out_grad" was declared but never referenced
          detected during instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const int8_t *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t, __nv_bool) [with act_type=ActivationType::kRelu, T=float]" 
(1601): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1513): warning: variable "temp_cmax_out_grad" was declared but never referenced
          detected during instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const int8_t *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t, __nv_bool) [with act_type=ActivationType::kRelu, T=float]" 
(1601): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1545): warning: variable "block_cmax_out_grad" was declared but never referenced
          detected during instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const int8_t *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t, __nv_bool) [with act_type=ActivationType::kRelu, T=float]" 
(1601): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1667): warning: variable "cmax_in_val" was declared but never referenced
          detected during:
            instantiation of "void ls_quant_dropout_act_bias_bwd_kernel<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, float, int) [with act_type=ActivationType::kRelu, T=float]" 
(1751): here
            instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t) [with act_type=ActivationType::kRelu, T=float]" 
(1754): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1667): warning: variable "cmax_in_val" was declared but never referenced
          detected during:
            instantiation of "void ls_quant_dropout_act_bias_bwd_kernel<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, float, int) [with act_type=ActivationType::kGelu, T=float]" 
(1751): here
            instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t) [with act_type=ActivationType::kGelu, T=float]" 
(1770): here

[12/18] c++ -MMD -MF transformer_encoder_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/transformer_encoder_layer.cpp -o transformer_encoder_layer.o 
[13/18] c++ -MMD -MF transformer_decoder_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/transformer_decoder_layer.cpp -o transformer_decoder_layer.o 
[14/18] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/softmax_kernels.cu -o softmax_kernels.cuda.o 
[15/18] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/cross_entropy.cu -o cross_entropy.cuda.o 
[16/18] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/cuda_util.cu -o cuda_util.cuda.o 
[17/18] c++ -MMD -MF pybind_layer.o.d -DTORCH_EXTENSION_NAME=lightseq_layers -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/pybind/pybind_layer.cpp -o pybind_layer.o 
[18/18] c++ cublas_algo_map.o cublas_wrappers.o quantize_kernels.cuda.o transform_kernels.cuda.o dropout_kernels.cuda.o normalize_kernels.cuda.o softmax_kernels.cuda.o general_kernels.cuda.o cuda_util.cuda.o embedding_kernels.cuda.o cross_entropy.cuda.o cross_entropy_layer.o quant_linear_layer.o transformer_encoder_layer.o transformer_decoder_layer.o transformer_embedding_layer.o pybind_layer.o -shared -L/opt/conda/lib/python3.7/site-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda_cu -ltorch_cuda_cpp -ltorch -ltorch_python -L/usr/local/cuda/lib64 -lcudart -o lightseq_layers.so
Time to load lightseq_layers op: 40.014951944351196 seconds
Time to load lightseq_layers op: 0.03761458396911621 seconds
Time to load lightseq_layers op: 0.04109954833984375 seconds
Time to load lightseq_layers op: 0.03746962547302246 seconds
[1/14] c++ -MMD -MF gemm_test.o.d -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/gemm_test.cpp -o gemm_test.o 
[2/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/general_kernels.cu -o general_kernels.cuda.o 
[3/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/transform_kernels_new.cu -o transform_kernels_new.cuda.o 
[4/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/transform_kernels.cu -o transform_kernels.cuda.o 
[5/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/embedding_kernels.cu -o embedding_kernels.cuda.o 
[6/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/normalize_kernels.cu -o normalize_kernels.cuda.o 
[7/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/crf.cu -o crf.cuda.o 
[8/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/quantize_kernels.cu -o quantize_kernels.cuda.o 
[9/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu -o dropout_kernels.cuda.o 
/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1509): warning: variable "thread_cmax_out_grad" was declared but never referenced
          detected during instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const int8_t *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t, __nv_bool) [with act_type=ActivationType::kRelu, T=float]" 
(1601): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1513): warning: variable "temp_cmax_out_grad" was declared but never referenced
          detected during instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const int8_t *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t, __nv_bool) [with act_type=ActivationType::kRelu, T=float]" 
(1601): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1545): warning: variable "block_cmax_out_grad" was declared but never referenced
          detected during instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const int8_t *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t, __nv_bool) [with act_type=ActivationType::kRelu, T=float]" 
(1601): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1667): warning: variable "cmax_in_val" was declared but never referenced
          detected during:
            instantiation of "void ls_quant_dropout_act_bias_bwd_kernel<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, float, int) [with act_type=ActivationType::kRelu, T=float]" 
(1751): here
            instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t) [with act_type=ActivationType::kRelu, T=float]" 
(1754): here

/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/dropout_kernels.cu(1667): warning: variable "cmax_in_val" was declared but never referenced
          detected during:
            instantiation of "void ls_quant_dropout_act_bias_bwd_kernel<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, float, int) [with act_type=ActivationType::kGelu, T=float]" 
(1751): here
            instantiation of "void launch_ls_quant_dropout_act_bias_bwd<act_type,T>(T *, T *, T *, T *, const T *, const T *, const uint8_t *, const uint8_t *, const T *, const T *, const uint8_t *, int, int, float, cudaStream_t) [with act_type=ActivationType::kGelu, T=float]" 
(1770): here

[10/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/softmax_kernels.cu -o softmax_kernels.cuda.o 
[11/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/softmax_kernels_new.cu -o softmax_kernels_new.cuda.o 
[12/14] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -DTHRUST_IGNORE_CUB_VERSION_CHECK -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/cuda_util.cu -o cuda_util.cuda.o 
[13/14] c++ -MMD -MF pybind_kernel.o.d -DTORCH_EXTENSION_NAME=lightseq_kernels -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/pybind/pybind_kernel.cpp -o pybind_kernel.o 
[14/14] c++ gemm_test.o cuda_util.cuda.o transform_kernels.cuda.o transform_kernels_new.cuda.o softmax_kernels.cuda.o softmax_kernels_new.cuda.o general_kernels.cuda.o normalize_kernels.cuda.o dropout_kernels.cuda.o embedding_kernels.cuda.o quantize_kernels.cuda.o crf.cuda.o pybind_kernel.o -shared -L/opt/conda/lib/python3.7/site-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda_cu -ltorch_cuda_cpp -ltorch -ltorch_python -L/usr/local/cuda/lib64 -lcudart -o lightseq_kernels.so
Time to load lightseq_kernels op: 38.96724987030029 seconds
2024-12-12 04:51:34 | INFO | fairseq_cli.train | Namespace(GCQ_quantile=0.99, activation_dropout=0.1, activation_fn='relu', adam_betas='(0.9, 0.98)', adam_eps=1e-08, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, all_gather_list_size=16384, arch='ls_transformer_wmt_en_de_big_t2t', attention_dropout=0.1, batch_size=None, batch_size_valid=None, best_checkpoint_metric='loss', bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_activations=False, checkpoint_shard_count=1, checkpoint_suffix='', clip_norm=0.0, cpu=False, criterion='ls_label_smoothed_cross_entropy', cross_self_attention=False, curriculum=0, data='/tmp/wmt14_en_de/', data_buffer_size=10, dataset_impl=None, ddp_backend='c10d', decoder_attention_heads=16, decoder_embed_dim=1024, decoder_embed_path=None, decoder_ffn_embed_dim=4096, decoder_input_dim=1024, decoder_layerdrop=0, decoder_layers=6, decoder_layers_to_keep=None, decoder_learned_pos=False, decoder_normalize_before=True, decoder_output_dim=1024, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method=None, distributed_no_spawn=False, distributed_num_procs=1, distributed_port=-1, distributed_rank=0, distributed_world_size=1, distributed_wrapper='DDP', dropout=0.3, empty_cache_freq=0, enable_GCQ=False, enable_quant=False, encoder_attention_heads=16, encoder_embed_dim=1024, encoder_embed_path=None, encoder_ffn_embed_dim=4096, encoder_layerdrop=0, encoder_layers=6, encoder_layers_to_keep=None, encoder_learned_pos=False, encoder_normalize_before=True, eval_bleu=False, eval_bleu_args=None, eval_bleu_detok='space', eval_bleu_detok_args=None, eval_bleu_print_samples=False, eval_bleu_remove_bpe=None, eval_tokenized_bleu=False, fast_stat_sync=False, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, fp16=True, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, gen_subset='test', ignore_prefix_size=0, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, label_smoothing=0.1, layernorm_embedding=False, left_pad_source='True', left_pad_target='False', load_alignments=False, localsgd_frequency=3, log_format='simple', log_interval=10, lr=[0.0005], lr_scheduler='inverse_sqrt', max_epoch=0, max_source_positions=300, max_target_positions=300, max_tokens=1024, max_tokens_valid=1024, max_update=0, maximize_best_checkpoint_metric=False, memory_efficient_bf16=False, memory_efficient_fp16=True, min_loss_scale=0.0001, min_lr=-1.0, min_params_to_wrap=100000000, model_parallel_size=1, no_cross_attention=False, no_epoch_checkpoints=False, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_scale_embedding=False, no_seed_provided=False, no_token_positional_embeddings=False, nprocs_per_node=1, num_batch_buckets=0, num_shards=1, num_workers=1, offload_activations=False, optimizer='ls_adam', optimizer_overrides='{}', patience=-1, pipeline_balance=None, pipeline_checkpoint='never', pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, profile=False, quant_mode='qat', quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, report_accuracy=False, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='checkpoints', save_interval=1, save_interval_updates=0, scoring='bleu', seed=1, sentence_avg=False, shard_id=0, share_all_embeddings=False, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm='LocalSGD', slowmo_momentum=None, source_lang=None, stop_time_hours=0.05, target_lang=None, task='translation', tensorboard_logdir=None, threshold_loss_scale=None, tie_adaptive_weights=False, tokenizer=None, tpu=False, train_subset='train', truncate_source=False, update_freq=[1], upsample_primary=1, use_bmuf=False, use_old_adam=False, use_torch_layer=False, user_dir='/opt/conda/lib/python3.7/site-packages/lightseq/training/cli/fs_modules', valid_subset='valid', validate_after_updates=0, validate_interval=1, validate_interval_updates=0, warmup_init_lr=-1, warmup_updates=4000, weight_decay=0.0001, zero_sharding='none')
2024-12-12 04:51:34 | INFO | fairseq.tasks.translation | [en] dictionary: 40480 types
2024-12-12 04:51:34 | INFO | fairseq.tasks.translation | [de] dictionary: 42720 types
2024-12-12 04:51:34 | INFO | fairseq.data.data_utils | loaded 39414 examples from: /tmp/wmt14_en_de/valid.en-de.en
2024-12-12 04:51:34 | INFO | fairseq.data.data_utils | loaded 39414 examples from: /tmp/wmt14_en_de/valid.en-de.de
2024-12-12 04:51:34 | INFO | fairseq.tasks.translation | /tmp/wmt14_en_de/ valid en-de 39414 examples
Initial Context, status_type: Training
Embedding layer #0 is created with date type [half].
Embedding layer #1 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Encoder layer #0 allocate shared memory size: 10158080
Encoder layer #0 allocate shared quant memory size: 9437184
Encoder layer #0 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Encoder layer #1 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Encoder layer #2 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Encoder layer #3 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Encoder layer #4 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Encoder layer #5 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Decoder layer #0 allocate shared memory size: 10158080
Decoder layer #0 allocate shared quant memory size: 9437184
Decoder layer #0 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Decoder layer #1 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Decoder layer #2 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Decoder layer #3 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Decoder layer #4 is created with date type [half].
Get igemm config from /home/mwm2166/.lightseq/igemm_configs/
[WARNING] /home/mwm2166/.lightseq/igemm_configs/ is not found; using default GEMM algo
Decoder layer #5 is created with date type [half].
QuantLinearLayer is created with date type [half].
CrossEntropyLayer is created with date type [half].
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'activation_fn': 'relu', 'layer_id': 0}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'activation_fn': 'relu', 'layer_id': 1}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'activation_fn': 'relu', 'layer_id': 2}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'activation_fn': 'relu', 'layer_id': 3}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'activation_fn': 'relu', 'layer_id': 4}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'activation_fn': 'relu', 'layer_id': 5}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'nlayer': 6, 'activation_fn': 'relu', 'has_cross_attn': True, 'layer_id': 0}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'nlayer': 6, 'activation_fn': 'relu', 'has_cross_attn': True, 'layer_id': 1}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'nlayer': 6, 'activation_fn': 'relu', 'has_cross_attn': True, 'layer_id': 2}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'nlayer': 6, 'activation_fn': 'relu', 'has_cross_attn': True, 'layer_id': 3}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'nlayer': 6, 'activation_fn': 'relu', 'has_cross_attn': True, 'layer_id': 4}
Lightseq Transformer config is  {'max_batch_tokens': 1024, 'max_seq_len': 300, 'hidden_size': 1024, 'intermediate_size': 4096, 'nhead': 16, 'attn_prob_dropout_ratio': 0.1, 'activation_dropout_ratio': 0.1, 'hidden_dropout_ratio': 0.3, 'pre_layer_norm': True, 'fp16': True, 'local_rank': 0, 'nlayer': 6, 'activation_fn': 'relu', 'has_cross_attn': True, 'layer_id': 5}
Time to load lightseq_layers op: 0.04103827476501465 seconds
Time to load lightseq_layers op: 0.038474082946777344 seconds
2024-12-12 04:51:36 | INFO | fairseq_cli.train | LSTransformerModel(
  (encoder): LSTransformerEncoder(
    (embed_tokens): LSTransformerEmbeddingLayer()
    (layers): ModuleList(
      (0): LSTransformerEncoderLayer()
      (1): LSTransformerEncoderLayer()
      (2): LSTransformerEncoderLayer()
      (3): LSTransformerEncoderLayer()
      (4): LSTransformerEncoderLayer()
      (5): LSTransformerEncoderLayer()
    )
    (layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
  )
  (decoder): LSTransformerDecoder(
    (embed_tokens): LSTransformerEmbeddingLayer()
    (layers): ModuleList(
      (0): LSFSTransformerDecoderLayer()
      (1): LSFSTransformerDecoderLayer()
      (2): LSFSTransformerDecoderLayer()
      (3): LSFSTransformerDecoderLayer()
      (4): LSFSTransformerDecoderLayer()
      (5): LSFSTransformerDecoderLayer()
    )
    (layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (output_projection): LSQuantLinearLayer()
  )
)
2024-12-12 04:51:36 | INFO | fairseq_cli.train | task: translation (TranslationTask)
2024-12-12 04:51:36 | INFO | fairseq_cli.train | model: ls_transformer_wmt_en_de_big_t2t (LSTransformerModel)
2024-12-12 04:51:36 | INFO | fairseq_cli.train | criterion: ls_label_smoothed_cross_entropy (LSLabelSmoothedCrossEntropyCriterion)
2024-12-12 04:51:36 | INFO | fairseq_cli.train | num. model params: 261558490 (num. trained: 261558490)
2024-12-12 04:51:37 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2024-12-12 04:51:37 | INFO | fairseq.utils | rank   0: capabilities =  7.0  ; total memory = 15.782 GB ; name = Tesla V100-SXM2-16GB                    
2024-12-12 04:51:37 | INFO | fairseq.utils | ***********************CUDA enviroments for all 1 workers***********************
2024-12-12 04:51:37 | INFO | fairseq_cli.train | training on 1 devices (GPUs/TPUs)
2024-12-12 04:51:37 | INFO | fairseq_cli.train | max tokens per GPU = 1024 and max sentences per GPU = None
2024-12-12 04:51:37 | INFO | fairseq.trainer | no existing checkpoint found checkpoints/checkpoint_last.pt
2024-12-12 04:51:37 | INFO | fairseq.trainer | loading train data for epoch 1
2024-12-12 04:51:37 | INFO | fairseq.data.data_utils | loaded 3900502 examples from: /tmp/wmt14_en_de/train.en-de.en
2024-12-12 04:51:37 | INFO | fairseq.data.data_utils | loaded 3900502 examples from: /tmp/wmt14_en_de/train.en-de.de
2024-12-12 04:51:37 | INFO | fairseq.tasks.translation | /tmp/wmt14_en_de/ train en-de 3900502 examples
2024-12-12 04:51:41 | INFO | fs_modules.ls_adam | using LightSeq Adam
[1/3] c++ -MMD -MF pybind_adam.o.d -DTORCH_EXTENSION_NAME=adam -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -fPIC -std=c++14 -O3 -std=c++14 -g -Wno-reorder -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/pybind/pybind_adam.cpp -o pybind_adam.o 
[2/3] /usr/local/cuda/bin/nvcc  -DTORCH_EXTENSION_NAME=adam -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1011\" -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/ops/includes -I/opt/conda/lib/python3.7/site-packages/lightseq/csrc/layers/includes -isystem /opt/conda/lib/python3.7/site-packages/torch/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/torch/csrc/api/include -isystem /opt/conda/lib/python3.7/site-packages/torch/include/TH -isystem /opt/conda/lib/python3.7/site-packages/torch/include/THC -isystem /usr/local/cuda/include -isystem /opt/conda/include/python3.7m -D_GLIBCXX_USE_CXX11_ABI=0 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_70,code=compute_70 -gencode=arch=compute_70,code=sm_70 --compiler-options '-fPIC' -O3 --use_fast_math -std=c++14 -U__CUDA_NO_HALF_OPERATORS__ -U__CUDA_NO_HALF_CONVERSIONS__ -U__CUDA_NO_HALF2_OPERATORS__ -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_70,code=compute_70 -c /opt/conda/lib/python3.7/site-packages/lightseq/csrc/kernels/fused_adam_kernel.cu -o fused_adam_kernel.cuda.o 
[3/3] c++ fused_adam_kernel.cuda.o pybind_adam.o -shared -L/opt/conda/lib/python3.7/site-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda_cu -ltorch_cuda_cpp -ltorch -ltorch_python -L/usr/local/cuda/lib64 -lcudart -o adam.so
Time to load adam op: 54.5716872215271 seconds
2024-12-12 04:52:35 | INFO | fairseq.trainer | begin training epoch 1
TransformerEmbeddingLayer #0 bind weights and grads.
TransformerEncoderLayer #0 bind weights and grads.
TransformerEncoderLayer #1 bind weights and grads.
TransformerEncoderLayer #2 bind weights and grads.
TransformerEncoderLayer #3 bind weights and grads.
TransformerEncoderLayer #4 bind weights and grads.
TransformerEncoderLayer #5 bind weights and grads.
TransformerEmbeddingLayer #1 bind weights and grads.
TransformerDecoderLayer #0 bind weights and grads.
Decoder layer #0 allocate encdec_kv memory
TransformerDecoderLayer #1 bind weights and grads.
TransformerDecoderLayer #2 bind weights and grads.
TransformerDecoderLayer #3 bind weights and grads.
TransformerDecoderLayer #4 bind weights and grads.
TransformerDecoderLayer #5 bind weights and grads.
2024-12-12 04:52:36 | INFO | train_inner | epoch 001:     10 / 145082 loss=25.584, nll_loss=25.588, ppl=5.04463e+07, wps=18103.7, ups=22.27, wpb=808.8, bsz=27.2, num_updates=10, lr=1.25e-06, gnorm=14.425, loss_scale=128, train_wall=0, wall=59
2024-12-12 04:52:36 | INFO | train_inner | epoch 001:     20 / 145082 loss=25.317, nll_loss=25.317, ppl=4.18065e+07, wps=18331.3, ups=24.02, wpb=763.1, bsz=23.2, num_updates=20, lr=2.5e-06, gnorm=14.843, loss_scale=128, train_wall=0, wall=60
2024-12-12 04:52:37 | INFO | train_inner | epoch 001:     30 / 145082 loss=23.728, nll_loss=23.723, ppl=1.38462e+07, wps=19191.5, ups=22.9, wpb=837.9, bsz=40.8, num_updates=30, lr=3.75e-06, gnorm=15.643, loss_scale=128, train_wall=0, wall=60
2024-12-12 04:52:37 | INFO | train_inner | epoch 001:     40 / 145082 loss=20.891, nll_loss=20.878, ppl=1.92762e+06, wps=18011.3, ups=23.43, wpb=768.8, bsz=24, num_updates=40, lr=5e-06, gnorm=15.217, loss_scale=128, train_wall=0, wall=60
2024-12-12 04:52:38 | INFO | train_inner | epoch 001:     50 / 145082 loss=17.123, nll_loss=17.098, ppl=140302, wps=19472.4, ups=23.17, wpb=840.3, bsz=28.8, num_updates=50, lr=6.25e-06, gnorm=7.298, loss_scale=128, train_wall=0, wall=61
2024-12-12 04:52:38 | INFO | train_inner | epoch 001:     60 / 145082 loss=16.024, nll_loss=15.982, ppl=64712.6, wps=18701, ups=23.24, wpb=804.8, bsz=29.6, num_updates=60, lr=7.5e-06, gnorm=3.526, loss_scale=128, train_wall=0, wall=61
2024-12-12 04:52:38 | INFO | train_inner | epoch 001:     70 / 145082 loss=15.594, nll_loss=15.517, ppl=46883.9, wps=17202.4, ups=24.53, wpb=701.3, bsz=20, num_updates=70, lr=8.75e-06, gnorm=3.152, loss_scale=128, train_wall=0, wall=62
2024-12-12 04:52:39 | INFO | train_inner | epoch 001:     80 / 145082 loss=15.26, nll_loss=15.147, ppl=36273.7, wps=16693.2, ups=24.49, wpb=681.6, bsz=22.4, num_updates=80, lr=1e-05, gnorm=2.881, loss_scale=128, train_wall=0, wall=62
2024-12-12 04:52:39 | INFO | train_inner | epoch 001:     90 / 145082 loss=14.944, nll_loss=14.792, ppl=28360.1, wps=17918.5, ups=23.88, wpb=750.4, bsz=22.4, num_updates=90, lr=1.125e-05, gnorm=2.502, loss_scale=128, train_wall=0, wall=63
2024-12-12 04:52:40 | INFO | train_inner | epoch 001:    100 / 145082 loss=14.6, nll_loss=14.406, ppl=21711.2, wps=18615.5, ups=23.75, wpb=783.7, bsz=27.2, num_updates=100, lr=1.25e-05, gnorm=2.259, loss_scale=128, train_wall=0, wall=63
2024-12-12 04:52:40 | INFO | train_inner | epoch 001:    110 / 145082 loss=14.315, nll_loss=14.088, ppl=17412.5, wps=18645.2, ups=22.98, wpb=811.2, bsz=24.8, num_updates=110, lr=1.375e-05, gnorm=2.004, loss_scale=128, train_wall=0, wall=63
2024-12-12 04:52:41 | INFO | train_inner | epoch 001:    120 / 145082 loss=14, nll_loss=13.738, ppl=13659.6, wps=19049.6, ups=23.21, wpb=820.8, bsz=22.4, num_updates=120, lr=1.5e-05, gnorm=1.86, loss_scale=128, train_wall=0, wall=64
2024-12-12 04:52:41 | INFO | train_inner | epoch 001:    130 / 145082 loss=13.687, nll_loss=13.391, ppl=10742.3, wps=19184.1, ups=23.81, wpb=805.6, bsz=33.6, num_updates=130, lr=1.625e-05, gnorm=1.802, loss_scale=128, train_wall=0, wall=64
2024-12-12 04:52:41 | INFO | train_inner | epoch 001:    140 / 145082 loss=13.48, nll_loss=13.16, ppl=9150.55, wps=19539.8, ups=23.33, wpb=837.6, bsz=24, num_updates=140, lr=1.75e-05, gnorm=1.735, loss_scale=128, train_wall=0, wall=65
2024-12-12 04:52:42 | INFO | train_inner | epoch 001:    150 / 145082 loss=13.312, nll_loss=12.974, ppl=8046.78, wps=17805.7, ups=23.83, wpb=747.2, bsz=25.6, num_updates=150, lr=1.875e-05, gnorm=1.703, loss_scale=128, train_wall=0, wall=65
2024-12-12 04:52:42 | INFO | train_inner | epoch 001:    160 / 145082 loss=13.099, nll_loss=12.734, ppl=6812.82, wps=17404, ups=23.8, wpb=731.2, bsz=21.6, num_updates=160, lr=2e-05, gnorm=1.719, loss_scale=128, train_wall=0, wall=66
2024-12-12 04:52:43 | INFO | train_inner | epoch 001:    170 / 145082 loss=12.937, nll_loss=12.551, ppl=6000.33, wps=19064.6, ups=22.94, wpb=831.2, bsz=28.8, num_updates=170, lr=2.125e-05, gnorm=1.496, loss_scale=128, train_wall=0, wall=66
2024-12-12 04:52:43 | INFO | train_inner | epoch 001:    180 / 145082 loss=12.729, nll_loss=12.317, ppl=5103.51, wps=19131.8, ups=22.71, wpb=842.4, bsz=34.4, num_updates=180, lr=2.25e-05, gnorm=1.609, loss_scale=128, train_wall=0, wall=66
2024-12-12 04:52:43 | INFO | train_inner | epoch 001:    190 / 145082 loss=12.666, nll_loss=12.242, ppl=4844.9, wps=18272.9, ups=24.12, wpb=757.6, bsz=22.4, num_updates=190, lr=2.375e-05, gnorm=1.541, loss_scale=128, train_wall=0, wall=67
2024-12-12 04:52:44 | INFO | train_inner | epoch 001:    200 / 145082 loss=12.647, nll_loss=12.217, ppl=4760.73, wps=18571.9, ups=23.33, wpb=796, bsz=25.6, num_updates=200, lr=2.5e-05, gnorm=1.381, loss_scale=128, train_wall=0, wall=67
2024-12-12 04:52:44 | INFO | train_inner | epoch 001:    210 / 145082 loss=12.435, nll_loss=11.976, ppl=4028.13, wps=17969.3, ups=23.47, wpb=765.6, bsz=24.8, num_updates=210, lr=2.625e-05, gnorm=1.623, loss_scale=128, train_wall=0, wall=68
2024-12-12 04:52:45 | INFO | train_inner | epoch 001:    220 / 145082 loss=12.394, nll_loss=11.924, ppl=3884.84, wps=19908.9, ups=23.46, wpb=848.8, bsz=25.6, num_updates=220, lr=2.75e-05, gnorm=1.423, loss_scale=128, train_wall=0, wall=68
2024-12-12 04:52:45 | INFO | train_inner | epoch 001:    230 / 145082 loss=12.418, nll_loss=11.947, ppl=3947.08, wps=20364.8, ups=24.82, wpb=820.5, bsz=22.4, num_updates=230, lr=2.875e-05, gnorm=1.306, loss_scale=128, train_wall=0, wall=69
2024-12-12 04:52:46 | INFO | train_inner | epoch 001:    240 / 145082 loss=12.187, nll_loss=11.685, ppl=3292.08, wps=20792.1, ups=23.95, wpb=868, bsz=32.8, num_updates=240, lr=3e-05, gnorm=1.737, loss_scale=128, train_wall=0, wall=69
2024-12-12 04:52:46 | INFO | train_inner | epoch 001:    250 / 145082 loss=12.055, nll_loss=11.53, ppl=2956.86, wps=19419.2, ups=25.31, wpb=767.2, bsz=24.8, num_updates=250, lr=3.125e-05, gnorm=1.478, loss_scale=128, train_wall=0, wall=69
2024-12-12 04:52:46 | INFO | train_inner | epoch 001:    260 / 145082 loss=12.097, nll_loss=11.571, ppl=3043.28, wps=19690.3, ups=24.37, wpb=808, bsz=25.6, num_updates=260, lr=3.25e-05, gnorm=1.519, loss_scale=128, train_wall=0, wall=70
2024-12-12 04:52:47 | INFO | train_inner | epoch 001:    270 / 145082 loss=12.008, nll_loss=11.466, ppl=2829.28, wps=19753.2, ups=25.07, wpb=788, bsz=28, num_updates=270, lr=3.375e-05, gnorm=1.67, loss_scale=128, train_wall=0, wall=70
2024-12-12 04:52:47 | INFO | train_inner | epoch 001:    280 / 145082 loss=11.964, nll_loss=11.411, ppl=2723.57, wps=19606.6, ups=24.99, wpb=784.5, bsz=23.1, num_updates=280, lr=3.5e-05, gnorm=1.709, loss_scale=128, train_wall=0, wall=71
2024-12-12 04:52:48 | INFO | train_inner | epoch 001:    290 / 145082 loss=11.856, nll_loss=11.287, ppl=2499.33, wps=19510.1, ups=24.56, wpb=794.4, bsz=25.6, num_updates=290, lr=3.625e-05, gnorm=1.456, loss_scale=128, train_wall=0, wall=71
2024-12-12 04:52:48 | INFO | train_inner | epoch 001:    300 / 145082 loss=11.863, nll_loss=11.287, ppl=2499.38, wps=19124.3, ups=24.59, wpb=777.8, bsz=21.6, num_updates=300, lr=3.75e-05, gnorm=1.35, loss_scale=128, train_wall=0, wall=71
2024-12-12 04:52:48 | INFO | train_inner | epoch 001:    310 / 145082 loss=11.899, nll_loss=11.325, ppl=2565.43, wps=18865.5, ups=24.41, wpb=772.8, bsz=35.2, num_updates=310, lr=3.875e-05, gnorm=1.858, loss_scale=128, train_wall=0, wall=72
2024-12-12 04:52:49 | INFO | train_inner | epoch 001:    320 / 145082 loss=11.944, nll_loss=11.371, ppl=2649.42, wps=19147.8, ups=24.6, wpb=778.4, bsz=18.4, num_updates=320, lr=4e-05, gnorm=1.395, loss_scale=128, train_wall=0, wall=72
2024-12-12 04:52:49 | INFO | train_inner | epoch 001:    330 / 145082 loss=11.801, nll_loss=11.209, ppl=2366.98, wps=19560.9, ups=24.67, wpb=792.8, bsz=27.2, num_updates=330, lr=4.125e-05, gnorm=1.514, loss_scale=128, train_wall=0, wall=73
2024-12-12 04:52:50 | INFO | train_inner | epoch 001:    340 / 145082 loss=11.855, nll_loss=11.265, ppl=2460.26, wps=19023.1, ups=24.77, wpb=768, bsz=30.2, num_updates=340, lr=4.25e-05, gnorm=1.663, loss_scale=128, train_wall=0, wall=73
2024-12-12 04:52:50 | INFO | train_inner | epoch 001:    350 / 145082 loss=11.908, nll_loss=11.319, ppl=2555.18, wps=20041.8, ups=25.05, wpb=800, bsz=21.6, num_updates=350, lr=4.375e-05, gnorm=1.32, loss_scale=128, train_wall=0, wall=73
2024-12-12 04:52:50 | INFO | train_inner | epoch 001:    360 / 145082 loss=11.703, nll_loss=11.088, ppl=2177.43, wps=20034.5, ups=24.26, wpb=825.7, bsz=31.2, num_updates=360, lr=4.5e-05, gnorm=1.28, loss_scale=128, train_wall=0, wall=74
2024-12-12 04:52:51 | INFO | train_inner | epoch 001:    370 / 145082 loss=11.823, nll_loss=11.216, ppl=2379.31, wps=20170.7, ups=24.65, wpb=818.4, bsz=28.8, num_updates=370, lr=4.625e-05, gnorm=1.23, loss_scale=128, train_wall=0, wall=74
2024-12-12 04:52:51 | INFO | train_inner | epoch 001:    380 / 145082 loss=11.74, nll_loss=11.123, ppl=2229.66, wps=19571.7, ups=24.78, wpb=789.8, bsz=31.2, num_updates=380, lr=4.75e-05, gnorm=1.419, loss_scale=128, train_wall=0, wall=75
2024-12-12 04:52:52 | INFO | train_inner | epoch 001:    390 / 145082 loss=11.623, nll_loss=10.989, ppl=2033.13, wps=18581.8, ups=25.75, wpb=721.6, bsz=26.4, num_updates=390, lr=4.875e-05, gnorm=1.365, loss_scale=128, train_wall=0, wall=75
2024-12-12 04:52:52 | INFO | train_inner | epoch 001:    400 / 145082 loss=11.71, nll_loss=11.088, ppl=2176.97, wps=20407.6, ups=24.36, wpb=837.6, bsz=24.8, num_updates=400, lr=5e-05, gnorm=1.265, loss_scale=128, train_wall=0, wall=75
2024-12-12 04:52:52 | INFO | train_inner | epoch 001:    410 / 145082 loss=11.705, nll_loss=11.081, ppl=2166.06, wps=18505.4, ups=25.45, wpb=727.2, bsz=16, num_updates=410, lr=5.125e-05, gnorm=1.309, loss_scale=128, train_wall=0, wall=76
2024-12-12 04:52:53 | INFO | train_inner | epoch 001:    420 / 145082 loss=11.573, nll_loss=10.927, ppl=1947.4, wps=19889.6, ups=24.3, wpb=818.4, bsz=35.2, num_updates=420, lr=5.25e-05, gnorm=1.515, loss_scale=128, train_wall=0, wall=76
2024-12-12 04:52:53 | INFO | train_inner | epoch 001:    430 / 145082 loss=11.559, nll_loss=10.911, ppl=1925.67, wps=20735.3, ups=24.45, wpb=848, bsz=28, num_updates=430, lr=5.375e-05, gnorm=1.531, loss_scale=128, train_wall=0, wall=77
2024-12-12 04:52:54 | INFO | train_inner | epoch 001:    440 / 145082 loss=11.598, nll_loss=10.958, ppl=1989.06, wps=17381.5, ups=26.24, wpb=662.4, bsz=16.8, num_updates=440, lr=5.5e-05, gnorm=1.496, loss_scale=128, train_wall=0, wall=77
2024-12-12 04:52:54 | INFO | train_inner | epoch 001:    450 / 145082 loss=11.534, nll_loss=10.88, ppl=1885.14, wps=21681.6, ups=23.4, wpb=926.4, bsz=28, num_updates=450, lr=5.625e-05, gnorm=1.423, loss_scale=128, train_wall=0, wall=77
2024-12-12 04:52:54 | INFO | train_inner | epoch 001:    460 / 145082 loss=11.49, nll_loss=10.831, ppl=1821.82, wps=18819.3, ups=24.68, wpb=762.4, bsz=30.4, num_updates=460, lr=5.75e-05, gnorm=1.87, loss_scale=128, train_wall=0, wall=78
2024-12-12 04:52:55 | INFO | train_inner | epoch 001:    470 / 145082 loss=11.477, nll_loss=10.818, ppl=1805.86, wps=19630.9, ups=25.1, wpb=782, bsz=23.2, num_updates=470, lr=5.875e-05, gnorm=1.461, loss_scale=128, train_wall=0, wall=78
2024-12-12 04:52:55 | INFO | train_inner | epoch 001:    480 / 145082 loss=11.424, nll_loss=10.754, ppl=1727.3, wps=20964.2, ups=23.69, wpb=884.8, bsz=39.2, num_updates=480, lr=6e-05, gnorm=1.449, loss_scale=128, train_wall=0, wall=79
2024-12-12 04:52:56 | INFO | train_inner | epoch 001:    490 / 145082 loss=11.473, nll_loss=10.812, ppl=1798.22, wps=20923.3, ups=24.51, wpb=853.6, bsz=31.2, num_updates=490, lr=6.125e-05, gnorm=1.427, loss_scale=128, train_wall=0, wall=79
2024-12-12 04:52:56 | INFO | train_inner | epoch 001:    500 / 145082 loss=11.382, nll_loss=10.704, ppl=1667.57, wps=19189.5, ups=24.82, wpb=773, bsz=31.2, num_updates=500, lr=6.25e-05, gnorm=2.036, loss_scale=128, train_wall=0, wall=79
2024-12-12 04:52:57 | INFO | train_inner | epoch 001:    510 / 145082 loss=11.561, nll_loss=10.914, ppl=1928.97, wps=18845.3, ups=24.9, wpb=756.8, bsz=17.6, num_updates=510, lr=6.375e-05, gnorm=1.415, loss_scale=128, train_wall=0, wall=80
2024-12-12 04:52:57 | INFO | train_inner | epoch 001:    520 / 145082 loss=11.608, nll_loss=10.964, ppl=1998.22, wps=19247.6, ups=25.02, wpb=769.2, bsz=21.6, num_updates=520, lr=6.5e-05, gnorm=1.919, loss_scale=128, train_wall=0, wall=80
2024-12-12 04:52:57 | INFO | train_inner | epoch 001:    530 / 145082 loss=11.429, nll_loss=10.753, ppl=1725.38, wps=21338.6, ups=24.01, wpb=888.6, bsz=32.8, num_updates=530, lr=6.625e-05, gnorm=1.678, loss_scale=128, train_wall=0, wall=81
2024-12-12 04:52:58 | INFO | train_inner | epoch 001:    540 / 145082 loss=11.32, nll_loss=10.638, ppl=1594.02, wps=19561.7, ups=24.23, wpb=807.2, bsz=32.8, num_updates=540, lr=6.75e-05, gnorm=1.533, loss_scale=128, train_wall=0, wall=81
2024-12-12 04:52:58 | INFO | train_inner | epoch 001:    550 / 145082 loss=11.283, nll_loss=10.598, ppl=1550.22, wps=20236.9, ups=23.84, wpb=848.8, bsz=35.2, num_updates=550, lr=6.875e-05, gnorm=1.39, loss_scale=128, train_wall=0, wall=82
2024-12-12 04:52:59 | INFO | train_inner | epoch 001:    560 / 145082 loss=11.262, nll_loss=10.578, ppl=1528.12, wps=20742.7, ups=24.23, wpb=856, bsz=29.6, num_updates=560, lr=7e-05, gnorm=1.472, loss_scale=128, train_wall=0, wall=82
2024-12-12 04:52:59 | INFO | train_inner | epoch 001:    570 / 145082 loss=11.366, nll_loss=10.683, ppl=1644.46, wps=20371.9, ups=24.04, wpb=847.5, bsz=37.2, num_updates=570, lr=7.125e-05, gnorm=1.755, loss_scale=128, train_wall=0, wall=82
2024-12-12 04:52:59 | INFO | train_inner | epoch 001:    580 / 145082 loss=11.441, nll_loss=10.774, ppl=1751.54, wps=20853.5, ups=24.45, wpb=852.8, bsz=30.4, num_updates=580, lr=7.25e-05, gnorm=1.949, loss_scale=128, train_wall=0, wall=83
2024-12-12 04:53:00 | INFO | train_inner | epoch 001:    590 / 145082 loss=11.394, nll_loss=10.723, ppl=1690.05, wps=20858.2, ups=24.21, wpb=861.4, bsz=31.2, num_updates=590, lr=7.375e-05, gnorm=1.546, loss_scale=128, train_wall=0, wall=83
2024-12-12 04:53:00 | INFO | train_inner | epoch 001:    600 / 145082 loss=11.413, nll_loss=10.747, ppl=1718.06, wps=20657.8, ups=24.22, wpb=852.8, bsz=28, num_updates=600, lr=7.5e-05, gnorm=1.533, loss_scale=128, train_wall=0, wall=84
2024-12-12 04:53:01 | INFO | train_inner | epoch 001:    610 / 145082 loss=11.403, nll_loss=10.734, ppl=1703.37, wps=20301.3, ups=24.61, wpb=824.9, bsz=29.6, num_updates=610, lr=7.625e-05, gnorm=1.628, loss_scale=128, train_wall=0, wall=84
2024-12-12 04:53:01 | INFO | train_inner | epoch 001:    620 / 145082 loss=11.231, nll_loss=10.532, ppl=1480.63, wps=18754, ups=24.14, wpb=776.8, bsz=30.4, num_updates=620, lr=7.75e-05, gnorm=1.718, loss_scale=128, train_wall=0, wall=84
2024-12-12 04:53:01 | INFO | train_inner | epoch 001:    630 / 145082 loss=11.359, nll_loss=10.686, ppl=1647.32, wps=18605.6, ups=24.74, wpb=752, bsz=20.8, num_updates=630, lr=7.875e-05, gnorm=1.559, loss_scale=128, train_wall=0, wall=85
2024-12-12 04:53:02 | INFO | train_inner | epoch 001:    640 / 145082 loss=11.508, nll_loss=10.855, ppl=1852.21, wps=17907.2, ups=25.26, wpb=708.8, bsz=20, num_updates=640, lr=8e-05, gnorm=1.461, loss_scale=128, train_wall=0, wall=85
2024-12-12 04:53:02 | INFO | train_inner | epoch 001:    650 / 145082 loss=11.123, nll_loss=10.414, ppl=1364.38, wps=19641.9, ups=23.41, wpb=839.2, bsz=28.8, num_updates=650, lr=8.125e-05, gnorm=1.249, loss_scale=128, train_wall=0, wall=86
2024-12-12 04:53:03 | INFO | train_inner | epoch 001:    660 / 145082 loss=11.212, nll_loss=10.517, ppl=1464.89, wps=18759.9, ups=23.47, wpb=799.2, bsz=23.2, num_updates=660, lr=8.25e-05, gnorm=1.449, loss_scale=128, train_wall=0, wall=86
2024-12-12 04:53:03 | INFO | train_inner | epoch 001:    670 / 145082 loss=11.348, nll_loss=10.668, ppl=1627.12, wps=18842.1, ups=24.84, wpb=758.4, bsz=22.4, num_updates=670, lr=8.375e-05, gnorm=1.566, loss_scale=128, train_wall=0, wall=86
2024-12-12 04:53:04 | INFO | train_inner | epoch 001:    680 / 145082 loss=11.338, nll_loss=10.661, ppl=1619.09, wps=20006.6, ups=24.59, wpb=813.6, bsz=23.2, num_updates=680, lr=8.5e-05, gnorm=1.641, loss_scale=128, train_wall=0, wall=87
2024-12-12 04:53:04 | INFO | train_inner | epoch 001:    690 / 145082 loss=11.228, nll_loss=10.532, ppl=1480.51, wps=20438.3, ups=24.33, wpb=840, bsz=30.4, num_updates=690, lr=8.625e-05, gnorm=1.858, loss_scale=128, train_wall=0, wall=87
2024-12-12 04:53:04 | INFO | train_inner | epoch 001:    700 / 145082 loss=11.261, nll_loss=10.562, ppl=1511.63, wps=19013.7, ups=25.12, wpb=756.8, bsz=21.6, num_updates=700, lr=8.75e-05, gnorm=1.63, loss_scale=128, train_wall=0, wall=88
2024-12-12 04:53:05 | INFO | train_inner | epoch 001:    710 / 145082 loss=11.304, nll_loss=10.625, ppl=1579.66, wps=19795.7, ups=24.3, wpb=814.7, bsz=21.6, num_updates=710, lr=8.875e-05, gnorm=1.443, loss_scale=128, train_wall=0, wall=88
2024-12-12 04:53:05 | INFO | train_inner | epoch 001:    720 / 145082 loss=11.112, nll_loss=10.405, ppl=1355.83, wps=19734.2, ups=24.77, wpb=796.8, bsz=28.8, num_updates=720, lr=9e-05, gnorm=1.55, loss_scale=128, train_wall=0, wall=88
2024-12-12 04:53:06 | INFO | train_inner | epoch 001:    730 / 145082 loss=11.101, nll_loss=10.393, ppl=1344.18, wps=21051.5, ups=24.16, wpb=871.2, bsz=32, num_updates=730, lr=9.125e-05, gnorm=1.343, loss_scale=128, train_wall=0, wall=89
2024-12-12 04:53:06 | INFO | train_inner | epoch 001:    740 / 145082 loss=11.054, nll_loss=10.338, ppl=1294.06, wps=19543.5, ups=24.24, wpb=806.4, bsz=32, num_updates=740, lr=9.25e-05, gnorm=1.571, loss_scale=128, train_wall=0, wall=89
2024-12-12 04:53:06 | INFO | train_inner | epoch 001:    750 / 145082 loss=10.953, nll_loss=10.221, ppl=1193.54, wps=21061, ups=23.67, wpb=889.7, bsz=29.6, num_updates=750, lr=9.375e-05, gnorm=1.619, loss_scale=128, train_wall=0, wall=90
2024-12-12 04:53:07 | INFO | train_inner | epoch 001:    760 / 145082 loss=11.083, nll_loss=10.375, ppl=1328.31, wps=19637.4, ups=24.86, wpb=789.9, bsz=24, num_updates=760, lr=9.5e-05, gnorm=1.55, loss_scale=128, train_wall=0, wall=90
2024-12-12 04:53:07 | INFO | train_inner | epoch 001:    770 / 145082 loss=11.186, nll_loss=10.479, ppl=1426.96, wps=12590.3, ups=16.82, wpb=748.6, bsz=20.8, num_updates=770, lr=9.625e-05, gnorm=1.47, loss_scale=128, train_wall=1, wall=91
2024-12-12 04:53:08 | INFO | train_inner | epoch 001:    780 / 145082 loss=11.142, nll_loss=10.445, ppl=1393.73, wps=18667.3, ups=25.1, wpb=743.8, bsz=26.4, num_updates=780, lr=9.75e-05, gnorm=1.842, loss_scale=128, train_wall=0, wall=91
2024-12-12 04:53:08 | INFO | train_inner | epoch 001:    790 / 145082 loss=10.896, nll_loss=10.148, ppl=1134.86, wps=21547.2, ups=23.55, wpb=915.1, bsz=36.6, num_updates=790, lr=9.875e-05, gnorm=1.524, loss_scale=128, train_wall=0, wall=92
2024-12-12 04:53:09 | INFO | train_inner | epoch 001:    800 / 145082 loss=11.209, nll_loss=10.52, ppl=1468.04, wps=18198.9, ups=23.38, wpb=778.4, bsz=23.2, num_updates=800, lr=0.0001, gnorm=1.396, loss_scale=128, train_wall=0, wall=92
2024-12-12 04:53:09 | INFO | train_inner | epoch 001:    810 / 145082 loss=11.062, nll_loss=10.344, ppl=1299.81, wps=18458.6, ups=22.84, wpb=808, bsz=28.8, num_updates=810, lr=0.00010125, gnorm=1.489, loss_scale=128, train_wall=0, wall=92
2024-12-12 04:53:10 | INFO | train_inner | epoch 001:    820 / 145082 loss=11.089, nll_loss=10.383, ppl=1335.03, wps=18465.1, ups=23.53, wpb=784.8, bsz=20.8, num_updates=820, lr=0.0001025, gnorm=1.542, loss_scale=128, train_wall=0, wall=93
2024-12-12 04:53:10 | INFO | train_inner | epoch 001:    830 / 145082 loss=10.979, nll_loss=10.253, ppl=1220.57, wps=19095.4, ups=23.03, wpb=829.1, bsz=29.6, num_updates=830, lr=0.00010375, gnorm=1.52, loss_scale=128, train_wall=0, wall=93
2024-12-12 04:53:10 | INFO | train_inner | epoch 001:    840 / 145082 loss=11.088, nll_loss=10.383, ppl=1335.55, wps=17028.2, ups=23.78, wpb=716, bsz=24.8, num_updates=840, lr=0.000105, gnorm=1.521, loss_scale=128, train_wall=0, wall=94
2024-12-12 04:53:11 | INFO | train_inner | epoch 001:    850 / 145082 loss=11.047, nll_loss=10.329, ppl=1286.14, wps=20524.5, ups=23.78, wpb=863.2, bsz=24, num_updates=850, lr=0.00010625, gnorm=1.662, loss_scale=128, train_wall=0, wall=94
2024-12-12 04:53:11 | INFO | train_inner | epoch 001:    860 / 145082 loss=10.962, nll_loss=10.236, ppl=1206.38, wps=19614.5, ups=23.26, wpb=843.2, bsz=27.2, num_updates=860, lr=0.0001075, gnorm=1.568, loss_scale=128, train_wall=0, wall=95
2024-12-12 04:53:12 | INFO | train_inner | epoch 001:    870 / 145082 loss=10.971, nll_loss=10.239, ppl=1208.24, wps=18382.9, ups=23.31, wpb=788.5, bsz=22.4, num_updates=870, lr=0.00010875, gnorm=1.631, loss_scale=128, train_wall=0, wall=95
2024-12-12 04:53:12 | INFO | train_inner | epoch 001:    880 / 145082 loss=10.983, nll_loss=10.265, ppl=1230.59, wps=18140.3, ups=23.28, wpb=779.2, bsz=31.2, num_updates=880, lr=0.00011, gnorm=1.621, loss_scale=128, train_wall=0, wall=95
2024-12-12 04:53:13 | INFO | train_inner | epoch 001:    890 / 145082 loss=10.973, nll_loss=10.246, ppl=1214.1, wps=18006.4, ups=23.28, wpb=773.6, bsz=20.8, num_updates=890, lr=0.00011125, gnorm=1.486, loss_scale=128, train_wall=0, wall=96
2024-12-12 04:53:13 | INFO | train_inner | epoch 001:    900 / 145082 loss=10.779, nll_loss=10.03, ppl=1045.16, wps=21536.3, ups=22.6, wpb=952.8, bsz=37.6, num_updates=900, lr=0.0001125, gnorm=1.471, loss_scale=128, train_wall=0, wall=96
2024-12-12 04:53:13 | INFO | train_inner | epoch 001:    910 / 145082 loss=10.793, nll_loss=10.038, ppl=1051.29, wps=18284.4, ups=23.35, wpb=783.2, bsz=35.2, num_updates=910, lr=0.00011375, gnorm=1.685, loss_scale=128, train_wall=0, wall=97
2024-12-12 04:53:14 | INFO | train_inner | epoch 001:    920 / 145082 loss=10.838, nll_loss=10.092, ppl=1091.18, wps=19095.2, ups=23.62, wpb=808.3, bsz=25.6, num_updates=920, lr=0.000115, gnorm=1.496, loss_scale=128, train_wall=0, wall=97
2024-12-12 04:53:14 | INFO | train_inner | epoch 001:    930 / 145082 loss=11.17, nll_loss=10.481, ppl=1429.64, wps=18062, ups=24.36, wpb=741.6, bsz=18.2, num_updates=930, lr=0.00011625, gnorm=1.555, loss_scale=128, train_wall=0, wall=98
2024-12-12 04:53:15 | INFO | train_inner | epoch 001:    940 / 145082 loss=10.859, nll_loss=10.103, ppl=1099.69, wps=19812.4, ups=23.04, wpb=860, bsz=28.8, num_updates=940, lr=0.0001175, gnorm=1.624, loss_scale=128, train_wall=0, wall=98
2024-12-12 04:53:15 | INFO | train_inner | epoch 001:    950 / 145082 loss=10.565, nll_loss=9.793, ppl=886.93, wps=18939.9, ups=23.52, wpb=805.3, bsz=32.8, num_updates=950, lr=0.00011875, gnorm=2.009, loss_scale=128, train_wall=0, wall=98
2024-12-12 04:53:15 | INFO | fairseq.trainer | NOTE: overflow detected, setting loss scale to: 64.0
2024-12-12 04:53:16 | INFO | train_inner | epoch 001:    961 / 145082 loss=11.045, nll_loss=10.321, ppl=1279.33, wps=16318.9, ups=21.96, wpb=743.2, bsz=22.4, num_updates=960, lr=0.00012, gnorm=2.057, loss_scale=64, train_wall=0, wall=99
2024-12-12 04:53:16 | INFO | train_inner | epoch 001:    971 / 145082 loss=10.911, nll_loss=10.166, ppl=1149, wps=18568.1, ups=22.93, wpb=809.6, bsz=27.2, num_updates=970, lr=0.00012125, gnorm=2.087, loss_scale=64, train_wall=0, wall=99
2024-12-12 04:53:16 | INFO | train_inner | epoch 001:    981 / 145082 loss=10.974, nll_loss=10.25, ppl=1217.43, wps=18618.5, ups=22.82, wpb=816, bsz=30.4, num_updates=980, lr=0.0001225, gnorm=1.757, loss_scale=64, train_wall=0, wall=100
2024-12-12 04:53:17 | INFO | train_inner | epoch 001:    991 / 145082 loss=11.068, nll_loss=10.365, ppl=1318.33, wps=19688.2, ups=24.66, wpb=798.3, bsz=25.2, num_updates=990, lr=0.00012375, gnorm=1.799, loss_scale=64, train_wall=0, wall=100
2024-12-12 04:53:17 | INFO | train_inner | epoch 001:   1001 / 145082 loss=10.9, nll_loss=10.163, ppl=1146.84, wps=19822.6, ups=24.61, wpb=805.6, bsz=30.4, num_updates=1000, lr=0.000125, gnorm=1.544, loss_scale=64, train_wall=0, wall=101
2024-12-12 04:53:18 | INFO | train_inner | epoch 001:   1011 / 145082 loss=10.847, nll_loss=10.103, ppl=1099.9, wps=19236.3, ups=25.26, wpb=761.6, bsz=19.2, num_updates=1010, lr=0.00012625, gnorm=1.552, loss_scale=64, train_wall=0, wall=101
2024-12-12 04:53:18 | INFO | train_inner | epoch 001:   1021 / 145082 loss=10.755, nll_loss=9.997, ppl=1022.21, wps=19892.2, ups=24.49, wpb=812.2, bsz=28, num_updates=1020, lr=0.0001275, gnorm=1.349, loss_scale=64, train_wall=0, wall=101
2024-12-12 04:53:18 | INFO | train_inner | epoch 001:   1031 / 145082 loss=10.906, nll_loss=10.173, ppl=1154.07, wps=20038.7, ups=25.2, wpb=795.2, bsz=23.2, num_updates=1030, lr=0.00012875, gnorm=1.387, loss_scale=64, train_wall=0, wall=102
2024-12-12 04:53:19 | INFO | train_inner | epoch 001:   1041 / 145082 loss=10.816, nll_loss=10.077, ppl=1080.29, wps=20489, ups=24.71, wpb=829.3, bsz=30.8, num_updates=1040, lr=0.00013, gnorm=1.514, loss_scale=64, train_wall=0, wall=102
2024-12-12 04:53:19 | INFO | train_inner | epoch 001:   1051 / 145082 loss=10.682, nll_loss=9.916, ppl=965.89, wps=18968.8, ups=25.66, wpb=739.2, bsz=24, num_updates=1050, lr=0.00013125, gnorm=1.527, loss_scale=64, train_wall=0, wall=103
2024-12-12 04:53:20 | INFO | train_inner | epoch 001:   1061 / 145082 loss=10.634, nll_loss=9.866, ppl=933.41, wps=21246.1, ups=23.82, wpb=892, bsz=32, num_updates=1060, lr=0.0001325, gnorm=1.486, loss_scale=64, train_wall=0, wall=103
2024-12-12 04:53:20 | INFO | train_inner | epoch 001:   1071 / 145082 loss=10.612, nll_loss=9.834, ppl=913, wps=20917.4, ups=24.25, wpb=862.4, bsz=27.2, num_updates=1070, lr=0.00013375, gnorm=1.357, loss_scale=64, train_wall=0, wall=103
2024-12-12 04:53:20 | INFO | train_inner | epoch 001:   1081 / 145082 loss=10.831, nll_loss=10.09, ppl=1089.73, wps=20650.3, ups=24.15, wpb=855.2, bsz=28.8, num_updates=1080, lr=0.000135, gnorm=1.602, loss_scale=64, train_wall=0, wall=104
2024-12-12 04:53:21 | INFO | train_inner | epoch 001:   1091 / 145082 loss=10.906, nll_loss=10.172, ppl=1153.37, wps=20133.2, ups=25.27, wpb=796.8, bsz=17.6, num_updates=1090, lr=0.00013625, gnorm=1.409, loss_scale=64, train_wall=0, wall=104
2024-12-12 04:53:21 | INFO | train_inner | epoch 001:   1101 / 145082 loss=10.61, nll_loss=9.834, ppl=912.56, wps=21008.6, ups=24.34, wpb=863.2, bsz=28, num_updates=1100, lr=0.0001375, gnorm=1.359, loss_scale=64, train_wall=0, wall=105
2024-12-12 04:53:22 | INFO | train_inner | epoch 001:   1111 / 145082 loss=10.934, nll_loss=10.204, ppl=1179.36, wps=20394.9, ups=25.05, wpb=814.2, bsz=20.8, num_updates=1110, lr=0.00013875, gnorm=1.477, loss_scale=64, train_wall=0, wall=105
2024-12-12 04:53:22 | INFO | train_inner | epoch 001:   1121 / 145082 loss=10.622, nll_loss=9.853, ppl=924.58, wps=20974.2, ups=24.56, wpb=854.1, bsz=28.8, num_updates=1120, lr=0.00014, gnorm=1.349, loss_scale=64, train_wall=0, wall=105
2024-12-12 04:53:22 | INFO | train_inner | epoch 001:   1131 / 145082 loss=10.614, nll_loss=9.847, ppl=920.81, wps=20478.9, ups=24.17, wpb=847.2, bsz=32.8, num_updates=1130, lr=0.00014125, gnorm=1.517, loss_scale=64, train_wall=0, wall=106
2024-12-12 04:53:23 | INFO | train_inner | epoch 001:   1141 / 145082 loss=10.834, nll_loss=10.086, ppl=1087.02, wps=19337.2, ups=24.68, wpb=783.4, bsz=22.2, num_updates=1140, lr=0.0001425, gnorm=1.707, loss_scale=64, train_wall=0, wall=106
2024-12-12 04:53:23 | INFO | train_inner | epoch 001:   1151 / 145082 loss=10.675, nll_loss=9.912, ppl=963.11, wps=19512.3, ups=24.64, wpb=792, bsz=20.8, num_updates=1150, lr=0.00014375, gnorm=1.669, loss_scale=64, train_wall=0, wall=107
2024-12-12 04:53:24 | INFO | train_inner | epoch 001:   1161 / 145082 loss=10.418, nll_loss=9.616, ppl=784.46, wps=19888.2, ups=24.47, wpb=812.8, bsz=30.4, num_updates=1160, lr=0.000145, gnorm=1.71, loss_scale=64, train_wall=0, wall=107
2024-12-12 04:53:24 | INFO | train_inner | epoch 001:   1171 / 145082 loss=10.572, nll_loss=9.791, ppl=886.17, wps=19667.9, ups=23.17, wpb=848.8, bsz=34.4, num_updates=1170, lr=0.00014625, gnorm=1.429, loss_scale=64, train_wall=0, wall=107
2024-12-12 04:53:25 | INFO | train_inner | epoch 001:   1181 / 145082 loss=10.564, nll_loss=9.782, ppl=880.45, wps=19277.2, ups=22.5, wpb=856.8, bsz=27.2, num_updates=1180, lr=0.0001475, gnorm=1.309, loss_scale=64, train_wall=0, wall=108
2024-12-12 04:53:25 | INFO | train_inner | epoch 001:   1191 / 145082 loss=10.577, nll_loss=9.801, ppl=892.09, wps=19879.4, ups=23.16, wpb=858.5, bsz=25.6, num_updates=1190, lr=0.00014875, gnorm=1.35, loss_scale=64, train_wall=0, wall=108
2024-12-12 04:53:25 | INFO | train_inner | epoch 001:   1201 / 145082 loss=10.526, nll_loss=9.737, ppl=853.38, wps=18287, ups=25.51, wpb=716.8, bsz=23.2, num_updates=1200, lr=0.00015, gnorm=1.536, loss_scale=64, train_wall=0, wall=109
2024-12-12 04:53:26 | INFO | train_inner | epoch 001:   1211 / 145082 loss=10.642, nll_loss=9.866, ppl=932.89, wps=18458.1, ups=25.56, wpb=722.2, bsz=16.8, num_updates=1210, lr=0.00015125, gnorm=1.487, loss_scale=64, train_wall=0, wall=109
2024-12-12 04:53:26 | INFO | train_inner | epoch 001:   1221 / 145082 loss=10.47, nll_loss=9.686, ppl=823.61, wps=20565.4, ups=24.02, wpb=856, bsz=33.6, num_updates=1220, lr=0.0001525, gnorm=1.345, loss_scale=64, train_wall=0, wall=110
2024-12-12 04:53:27 | INFO | train_inner | epoch 001:   1231 / 145082 loss=10.624, nll_loss=9.848, ppl=921.54, wps=20074.7, ups=24.94, wpb=804.8, bsz=22.4, num_updates=1230, lr=0.00015375, gnorm=1.446, loss_scale=64, train_wall=0, wall=110
2024-12-12 04:53:27 | INFO | train_inner | epoch 001:   1241 / 145082 loss=10.528, nll_loss=9.749, ppl=860.7, wps=18991.5, ups=24.68, wpb=769.6, bsz=22.4, num_updates=1240, lr=0.000155, gnorm=1.605, loss_scale=64, train_wall=0, wall=110
2024-12-12 04:53:27 | INFO | train_inner | epoch 001:   1251 / 145082 loss=10.565, nll_loss=9.77, ppl=873.08, wps=19787.2, ups=24.52, wpb=807.1, bsz=25.6, num_updates=1250, lr=0.00015625, gnorm=1.532, loss_scale=64, train_wall=0, wall=111
2024-12-12 04:53:28 | INFO | train_inner | epoch 001:   1261 / 145082 loss=10.491, nll_loss=9.704, ppl=834.34, wps=19050.1, ups=24.88, wpb=765.6, bsz=26.4, num_updates=1260, lr=0.0001575, gnorm=1.504, loss_scale=64, train_wall=0, wall=111
2024-12-12 04:53:28 | INFO | train_inner | epoch 001:   1271 / 145082 loss=10.395, nll_loss=9.593, ppl=772.3, wps=19947.9, ups=24.02, wpb=830.4, bsz=33.6, num_updates=1270, lr=0.00015875, gnorm=1.79, loss_scale=64, train_wall=0, wall=112
2024-12-12 04:53:29 | INFO | train_inner | epoch 001:   1281 / 145082 loss=10.488, nll_loss=9.696, ppl=829.44, wps=20659.3, ups=24.76, wpb=834.4, bsz=24.8, num_updates=1280, lr=0.00016, gnorm=1.33, loss_scale=64, train_wall=0, wall=112
2024-12-12 04:53:29 | INFO | train_inner | epoch 001:   1291 / 145082 loss=10.796, nll_loss=10.045, ppl=1056.47, wps=19871.7, ups=24.4, wpb=814.3, bsz=24.7, num_updates=1290, lr=0.00016125, gnorm=1.705, loss_scale=64, train_wall=0, wall=112
2024-12-12 04:53:29 | INFO | train_inner | epoch 001:   1301 / 145082 loss=10.515, nll_loss=9.726, ppl=846.63, wps=19894.3, ups=24.25, wpb=820.3, bsz=32, num_updates=1300, lr=0.0001625, gnorm=1.479, loss_scale=64, train_wall=0, wall=113
2024-12-12 04:53:30 | INFO | train_inner | epoch 001:   1311 / 145082 loss=10.581, nll_loss=9.799, ppl=890.93, wps=19906.7, ups=24.61, wpb=808.8, bsz=24, num_updates=1310, lr=0.00016375, gnorm=1.327, loss_scale=64, train_wall=0, wall=113
2024-12-12 04:53:30 | INFO | train_inner | epoch 001:   1321 / 145082 loss=10.713, nll_loss=9.951, ppl=989.8, wps=19084.2, ups=24.69, wpb=773, bsz=23.7, num_updates=1320, lr=0.000165, gnorm=1.621, loss_scale=64, train_wall=0, wall=114
2024-12-12 04:53:31 | INFO | train_inner | epoch 001:   1331 / 145082 loss=10.622, nll_loss=9.855, ppl=926.06, wps=20385.3, ups=24.45, wpb=833.6, bsz=23.2, num_updates=1330, lr=0.00016625, gnorm=1.577, loss_scale=64, train_wall=0, wall=114
2024-12-12 04:53:31 | INFO | train_inner | epoch 001:   1341 / 145082 loss=10.467, nll_loss=9.665, ppl=812.02, wps=19836.8, ups=24.55, wpb=808, bsz=27.2, num_updates=1340, lr=0.0001675, gnorm=1.471, loss_scale=64, train_wall=0, wall=114
2024-12-12 04:53:32 | INFO | train_inner | epoch 001:   1351 / 145082 loss=10.721, nll_loss=9.964, ppl=998.84, wps=19884.2, ups=25.26, wpb=787.2, bsz=23.2, num_updates=1350, lr=0.00016875, gnorm=1.582, loss_scale=64, train_wall=0, wall=115
2024-12-12 04:53:32 | INFO | train_inner | epoch 001:   1361 / 145082 loss=10.428, nll_loss=9.635, ppl=795.04, wps=21285.1, ups=23.97, wpb=888, bsz=24.8, num_updates=1360, lr=0.00017, gnorm=1.376, loss_scale=64, train_wall=0, wall=115
2024-12-12 04:53:32 | INFO | train_inner | epoch 001:   1371 / 145082 loss=10.167, nll_loss=9.326, ppl=641.76, wps=20028.2, ups=24.4, wpb=820.8, bsz=34.4, num_updates=1370, lr=0.00017125, gnorm=1.729, loss_scale=64, train_wall=0, wall=116
2024-12-12 04:53:33 | INFO | train_inner | epoch 001:   1381 / 145082 loss=10.341, nll_loss=9.529, ppl=738.68, wps=20758.4, ups=24.16, wpb=859.2, bsz=36.8, num_updates=1380, lr=0.0001725, gnorm=1.991, loss_scale=64, train_wall=0, wall=116
2024-12-12 04:53:33 | INFO | train_inner | epoch 001:   1391 / 145082 loss=10.539, nll_loss=9.754, ppl=863.72, wps=17945, ups=25.23, wpb=711.2, bsz=24, num_updates=1390, lr=0.00017375, gnorm=1.687, loss_scale=64, train_wall=0, wall=116
2024-12-12 04:53:34 | INFO | train_inner | epoch 001:   1401 / 145082 loss=10.433, nll_loss=9.631, ppl=792.75, wps=20190.7, ups=25.65, wpb=787.2, bsz=19.2, num_updates=1400, lr=0.000175, gnorm=1.563, loss_scale=64, train_wall=0, wall=117
2024-12-12 04:53:34 | INFO | train_inner | epoch 001:   1411 / 145082 loss=10.683, nll_loss=9.923, ppl=970.45, wps=18447.6, ups=25.28, wpb=729.6, bsz=20.8, num_updates=1410, lr=0.00017625, gnorm=1.56, loss_scale=64, train_wall=0, wall=117
2024-12-12 04:53:34 | INFO | train_inner | epoch 001:   1421 / 145082 loss=10.376, nll_loss=9.561, ppl=755.17, wps=20674.4, ups=24.59, wpb=840.8, bsz=26.4, num_updates=1420, lr=0.0001775, gnorm=1.522, loss_scale=64, train_wall=0, wall=118
2024-12-12 04:53:35 | INFO | train_inner | epoch 001:   1431 / 145082 loss=10.178, nll_loss=9.339, ppl=647.69, wps=20420.8, ups=24.66, wpb=828, bsz=28, num_updates=1430, lr=0.00017875, gnorm=1.444, loss_scale=64, train_wall=0, wall=118
2024-12-12 04:53:35 | INFO | train_inner | epoch 001:   1441 / 145082 loss=10.512, nll_loss=9.732, ppl=850.58, wps=19606.9, ups=25.34, wpb=773.6, bsz=19.2, num_updates=1440, lr=0.00018, gnorm=1.427, loss_scale=64, train_wall=0, wall=118
2024-12-12 04:53:36 | INFO | train_inner | epoch 001:   1451 / 145082 loss=10.324, nll_loss=9.507, ppl=727.68, wps=19245.8, ups=24.75, wpb=777.6, bsz=28.8, num_updates=1450, lr=0.00018125, gnorm=1.573, loss_scale=64, train_wall=0, wall=119
2024-12-12 04:53:36 | INFO | train_inner | epoch 001:   1461 / 145082 loss=10.192, nll_loss=9.357, ppl=655.71, wps=20408.6, ups=24.39, wpb=836.6, bsz=27.2, num_updates=1460, lr=0.0001825, gnorm=1.434, loss_scale=64, train_wall=0, wall=119
2024-12-12 04:53:36 | INFO | train_inner | epoch 001:   1471 / 145082 loss=10.501, nll_loss=9.717, ppl=841.85, wps=18884.4, ups=23.28, wpb=811.1, bsz=22.2, num_updates=1470, lr=0.00018375, gnorm=1.526, loss_scale=64, train_wall=0, wall=120
2024-12-12 04:53:37 | INFO | train_inner | epoch 001:   1481 / 145082 loss=10.53, nll_loss=9.736, ppl=852.48, wps=18469.2, ups=23.39, wpb=789.6, bsz=17.5, num_updates=1480, lr=0.000185, gnorm=1.472, loss_scale=64, train_wall=0, wall=120
2024-12-12 04:53:37 | INFO | train_inner | epoch 001:   1491 / 145082 loss=10.252, nll_loss=9.431, ppl=690.36, wps=18679.6, ups=22.64, wpb=825, bsz=51.2, num_updates=1490, lr=0.00018625, gnorm=2.512, loss_scale=64, train_wall=0, wall=121
2024-12-12 04:53:38 | INFO | train_inner | epoch 001:   1501 / 145082 loss=10.139, nll_loss=9.289, ppl=625.44, wps=20199.9, ups=24.67, wpb=818.7, bsz=44.8, num_updates=1500, lr=0.0001875, gnorm=1.948, loss_scale=64, train_wall=0, wall=121
2024-12-12 04:53:38 | INFO | train_inner | epoch 001:   1511 / 145082 loss=10.43, nll_loss=9.627, ppl=790.44, wps=20256.6, ups=24.75, wpb=818.4, bsz=23.2, num_updates=1510, lr=0.00018875, gnorm=1.506, loss_scale=64, train_wall=0, wall=121
2024-12-12 04:53:38 | INFO | train_inner | epoch 001:   1521 / 145082 loss=10.438, nll_loss=9.646, ppl=800.97, wps=18851.2, ups=24.6, wpb=766.4, bsz=27.2, num_updates=1520, lr=0.00019, gnorm=1.519, loss_scale=64, train_wall=0, wall=122
2024-12-12 04:53:39 | INFO | train_inner | epoch 001:   1531 / 145082 loss=10.407, nll_loss=9.602, ppl=776.91, wps=20206.3, ups=25.06, wpb=806.4, bsz=25.6, num_updates=1530, lr=0.00019125, gnorm=1.543, loss_scale=64, train_wall=0, wall=122
2024-12-12 04:53:39 | INFO | train_inner | epoch 001:   1541 / 145082 loss=10.339, nll_loss=9.536, ppl=742.37, wps=19846.2, ups=24.66, wpb=804.8, bsz=25.6, num_updates=1540, lr=0.0001925, gnorm=1.502, loss_scale=64, train_wall=0, wall=123
2024-12-12 04:53:40 | INFO | train_inner | epoch 001:   1551 / 145082 loss=10.471, nll_loss=9.673, ppl=816.52, wps=21378.9, ups=24.45, wpb=874.4, bsz=21.6, num_updates=1550, lr=0.00019375, gnorm=1.494, loss_scale=64, train_wall=0, wall=123
2024-12-12 04:53:40 | INFO | train_inner | epoch 001:   1561 / 145082 loss=10.074, nll_loss=9.23, ppl=600.43, wps=19546.3, ups=24.12, wpb=810.5, bsz=38.4, num_updates=1560, lr=0.000195, gnorm=1.48, loss_scale=64, train_wall=0, wall=123
2024-12-12 04:53:41 | INFO | train_inner | epoch 001:   1571 / 145082 loss=10.203, nll_loss=9.373, ppl=662.91, wps=20203.5, ups=24.66, wpb=819.2, bsz=30.4, num_updates=1570, lr=0.00019625, gnorm=1.478, loss_scale=64, train_wall=0, wall=124
2024-12-12 04:53:41 | INFO | train_inner | epoch 001:   1581 / 145082 loss=10.46, nll_loss=9.662, ppl=810.18, wps=20674.7, ups=24.92, wpb=829.6, bsz=24.8, num_updates=1580, lr=0.0001975, gnorm=1.424, loss_scale=64, train_wall=0, wall=124
2024-12-12 04:53:41 | INFO | train_inner | epoch 001:   1591 / 145082 loss=10.408, nll_loss=9.603, ppl=777.53, wps=19958.5, ups=24.43, wpb=816.8, bsz=27.2, num_updates=1590, lr=0.00019875, gnorm=1.684, loss_scale=64, train_wall=0, wall=125
2024-12-12 04:53:42 | INFO | train_inner | epoch 001:   1601 / 145082 loss=10.301, nll_loss=9.479, ppl=713.7, wps=18187.3, ups=25.69, wpb=708, bsz=19.2, num_updates=1600, lr=0.0002, gnorm=1.618, loss_scale=64, train_wall=0, wall=125
2024-12-12 04:53:42 | INFO | train_inner | epoch 001:   1611 / 145082 loss=10.135, nll_loss=9.292, ppl=626.87, wps=20760.4, ups=24.88, wpb=834.4, bsz=28.8, num_updates=1610, lr=0.00020125, gnorm=1.456, loss_scale=64, train_wall=0, wall=125
2024-12-12 04:53:43 | INFO | train_inner | epoch 001:   1621 / 145082 loss=10.505, nll_loss=9.719, ppl=842.82, wps=20409.1, ups=24.32, wpb=839.2, bsz=21.6, num_updates=1620, lr=0.0002025, gnorm=1.468, loss_scale=64, train_wall=0, wall=126
2024-12-12 04:53:43 | INFO | train_inner | epoch 001:   1631 / 145082 loss=10.145, nll_loss=9.305, ppl=632.41, wps=21156.1, ups=23.78, wpb=889.6, bsz=27.2, num_updates=1630, lr=0.00020375, gnorm=1.425, loss_scale=64, train_wall=0, wall=126
2024-12-12 04:53:43 | INFO | train_inner | epoch 001:   1641 / 145082 loss=10.387, nll_loss=9.576, ppl=763.45, wps=19329, ups=25.79, wpb=749.6, bsz=17.6, num_updates=1640, lr=0.000205, gnorm=1.498, loss_scale=64, train_wall=0, wall=127
2024-12-12 04:53:44 | INFO | train_inner | epoch 001:   1651 / 145082 loss=10.114, nll_loss=9.271, ppl=617.72, wps=21281.8, ups=24.91, wpb=854.4, bsz=30.4, num_updates=1650, lr=0.00020625, gnorm=1.479, loss_scale=64, train_wall=0, wall=127
2024-12-12 04:53:44 | INFO | train_inner | epoch 001:   1661 / 145082 loss=10.59, nll_loss=9.809, ppl=896.95, wps=19405.9, ups=25.01, wpb=776, bsz=20.8, num_updates=1660, lr=0.0002075, gnorm=1.567, loss_scale=64, train_wall=0, wall=127
2024-12-12 04:53:45 | INFO | train_inner | epoch 001:   1671 / 145082 loss=10.209, nll_loss=9.379, ppl=665.74, wps=19991.3, ups=24.6, wpb=812.8, bsz=27.2, num_updates=1670, lr=0.00020875, gnorm=1.404, loss_scale=64, train_wall=0, wall=128
2024-12-12 04:53:45 | INFO | train_inner | epoch 001:   1681 / 145082 loss=10.224, nll_loss=9.394, ppl=672.57, wps=20411.6, ups=24.6, wpb=829.6, bsz=32, num_updates=1680, lr=0.00021, gnorm=1.541, loss_scale=64, train_wall=0, wall=128
2024-12-12 04:53:45 | INFO | train_inner | epoch 001:   1691 / 145082 loss=10.074, nll_loss=9.217, ppl=595.13, wps=19144.1, ups=24.34, wpb=786.6, bsz=34.4, num_updates=1690, lr=0.00021125, gnorm=1.874, loss_scale=64, train_wall=0, wall=129
2024-12-12 04:53:46 | INFO | train_inner | epoch 001:   1701 / 145082 loss=9.994, nll_loss=9.134, ppl=561.85, wps=20222.7, ups=24.07, wpb=840, bsz=35.2, num_updates=1700, lr=0.0002125, gnorm=1.383, loss_scale=64, train_wall=0, wall=129
2024-12-12 04:53:46 | INFO | train_inner | epoch 001:   1711 / 145082 loss=10.367, nll_loss=9.558, ppl=753.83, wps=19975.9, ups=23.92, wpb=835.2, bsz=23.1, num_updates=1710, lr=0.00021375, gnorm=1.439, loss_scale=64, train_wall=0, wall=130
2024-12-12 04:53:47 | INFO | train_inner | epoch 001:   1721 / 145082 loss=10.285, nll_loss=9.46, ppl=704.52, wps=19887.9, ups=24.28, wpb=819.2, bsz=21.5, num_updates=1720, lr=0.000215, gnorm=1.448, loss_scale=64, train_wall=0, wall=130
2024-12-12 04:53:47 | INFO | train_inner | epoch 001:   1731 / 145082 loss=10.061, nll_loss=9.213, ppl=593.25, wps=20345.1, ups=23.92, wpb=850.4, bsz=34.4, num_updates=1730, lr=0.00021625, gnorm=1.423, loss_scale=64, train_wall=0, wall=130
2024-12-12 04:53:47 | INFO | train_inner | epoch 001:   1741 / 145082 loss=10.248, nll_loss=9.422, ppl=685.94, wps=19794.2, ups=24.92, wpb=794.4, bsz=20.8, num_updates=1740, lr=0.0002175, gnorm=1.564, loss_scale=64, train_wall=0, wall=131
2024-12-12 04:53:48 | INFO | train_inner | epoch 001:   1751 / 145082 loss=10.124, nll_loss=9.271, ppl=617.81, wps=20058.3, ups=24.9, wpb=805.4, bsz=25.6, num_updates=1750, lr=0.00021875, gnorm=1.485, loss_scale=64, train_wall=0, wall=131
2024-12-12 04:53:48 | INFO | train_inner | epoch 001:   1761 / 145082 loss=10.524, nll_loss=9.733, ppl=851.21, wps=18294.5, ups=24.78, wpb=738.4, bsz=16.8, num_updates=1760, lr=0.00022, gnorm=1.655, loss_scale=64, train_wall=0, wall=132
2024-12-12 04:53:49 | INFO | train_inner | epoch 001:   1771 / 145082 loss=10.262, nll_loss=9.447, ppl=698.05, wps=18674.7, ups=24.47, wpb=763.2, bsz=24, num_updates=1770, lr=0.00022125, gnorm=1.449, loss_scale=64, train_wall=0, wall=132
2024-12-12 04:53:49 | INFO | train_inner | epoch 001:   1781 / 145082 loss=10.275, nll_loss=9.445, ppl=697.23, wps=20510.6, ups=23.78, wpb=862.4, bsz=29.6, num_updates=1780, lr=0.0002225, gnorm=1.496, loss_scale=64, train_wall=0, wall=132
2024-12-12 04:53:49 | INFO | train_inner | epoch 001:   1791 / 145082 loss=10.028, nll_loss=9.177, ppl=578.8, wps=18731.8, ups=24.09, wpb=777.6, bsz=27.2, num_updates=1790, lr=0.00022375, gnorm=1.518, loss_scale=64, train_wall=0, wall=133
2024-12-12 04:53:50 | INFO | train_inner | epoch 001:   1801 / 145082 loss=10.193, nll_loss=9.365, ppl=659.45, wps=19309, ups=23.1, wpb=836, bsz=26.4, num_updates=1800, lr=0.000225, gnorm=1.454, loss_scale=64, train_wall=0, wall=133
2024-12-12 04:53:50 | INFO | train_inner | epoch 001:   1811 / 145082 loss=10.333, nll_loss=9.514, ppl=731.29, wps=18130.4, ups=23.41, wpb=774.4, bsz=20.8, num_updates=1810, lr=0.00022625, gnorm=1.382, loss_scale=64, train_wall=0, wall=134
2024-12-12 04:53:51 | INFO | train_inner | epoch 001:   1821 / 145082 loss=9.737, nll_loss=8.831, ppl=455.33, wps=18206.3, ups=23.37, wpb=779, bsz=30.4, num_updates=1820, lr=0.0002275, gnorm=1.548, loss_scale=64, train_wall=0, wall=134
2024-12-12 04:53:51 | INFO | train_inner | epoch 001:   1831 / 145082 loss=10.016, nll_loss=9.163, ppl=573.44, wps=18404, ups=23.79, wpb=773.6, bsz=22.4, num_updates=1830, lr=0.00022875, gnorm=1.462, loss_scale=64, train_wall=0, wall=135
2024-12-12 04:53:52 | INFO | train_inner | epoch 001:   1841 / 145082 loss=9.808, nll_loss=8.923, ppl=485.38, wps=19417.3, ups=23.41, wpb=829.6, bsz=32, num_updates=1840, lr=0.00023, gnorm=1.539, loss_scale=64, train_wall=0, wall=135
2024-12-12 04:53:52 | INFO | train_inner | epoch 001:   1851 / 145082 loss=10.102, nll_loss=9.259, ppl=612.54, wps=19910.1, ups=23, wpb=865.5, bsz=28.8, num_updates=1850, lr=0.00023125, gnorm=1.332, loss_scale=64, train_wall=0, wall=135
2024-12-12 04:53:52 | INFO | train_inner | epoch 001:   1861 / 145082 loss=9.943, nll_loss=9.072, ppl=538.35, wps=18775.6, ups=23.63, wpb=794.4, bsz=32, num_updates=1860, lr=0.0002325, gnorm=1.358, loss_scale=64, train_wall=0, wall=136
2024-12-12 04:53:53 | INFO | train_inner | epoch 001:   1871 / 145082 loss=10.07, nll_loss=9.219, ppl=595.86, wps=20228.9, ups=23.07, wpb=876.8, bsz=28, num_updates=1870, lr=0.00023375, gnorm=1.492, loss_scale=64, train_wall=0, wall=136
2024-12-12 04:53:53 | INFO | train_inner | epoch 001:   1881 / 145082 loss=10.025, nll_loss=9.159, ppl=571.79, wps=19531.7, ups=22.65, wpb=862.4, bsz=34.4, num_updates=1880, lr=0.000235, gnorm=1.785, loss_scale=64, train_wall=0, wall=137
2024-12-12 04:53:54 | INFO | train_inner | epoch 001:   1891 / 145082 loss=10.11, nll_loss=9.275, ppl=619.5, wps=19175.5, ups=23.52, wpb=815.2, bsz=24.8, num_updates=1890, lr=0.00023625, gnorm=1.589, loss_scale=64, train_wall=0, wall=137
2024-12-12 04:53:54 | INFO | train_inner | epoch 001:   1901 / 145082 loss=10.22, nll_loss=9.389, ppl=670.56, wps=18349.7, ups=23.79, wpb=771.2, bsz=21.6, num_updates=1900, lr=0.0002375, gnorm=1.558, loss_scale=64, train_wall=0, wall=138
2024-12-12 04:53:55 | INFO | train_inner | epoch 001:   1911 / 145082 loss=9.991, nll_loss=9.125, ppl=558.21, wps=20106.7, ups=23.14, wpb=868.8, bsz=29.6, num_updates=1910, lr=0.00023875, gnorm=1.606, loss_scale=64, train_wall=0, wall=138
2024-12-12 04:53:55 | INFO | train_inner | epoch 001:   1921 / 145082 loss=10.368, nll_loss=9.558, ppl=753.56, wps=18888.5, ups=23.26, wpb=812, bsz=20.8, num_updates=1920, lr=0.00024, gnorm=1.508, loss_scale=64, train_wall=0, wall=138
2024-12-12 04:53:55 | INFO | train_inner | epoch 001:   1931 / 145082 loss=9.942, nll_loss=9.069, ppl=537.24, wps=19206.7, ups=23.2, wpb=828, bsz=34.4, num_updates=1930, lr=0.00024125, gnorm=1.405, loss_scale=64, train_wall=0, wall=139
2024-12-12 04:53:56 | INFO | train_inner | epoch 001:   1941 / 145082 loss=10.067, nll_loss=9.224, ppl=597.87, wps=18850.2, ups=23.03, wpb=818.4, bsz=27.2, num_updates=1940, lr=0.0002425, gnorm=1.484, loss_scale=64, train_wall=0, wall=139
2024-12-12 04:53:56 | INFO | train_inner | epoch 001:   1951 / 145082 loss=10.129, nll_loss=9.281, ppl=622.15, wps=18721.3, ups=22.74, wpb=823.2, bsz=26.4, num_updates=1950, lr=0.00024375, gnorm=1.383, loss_scale=64, train_wall=0, wall=140
2024-12-12 04:53:57 | INFO | train_inner | epoch 001:   1961 / 145082 loss=10.151, nll_loss=9.318, ppl=638.46, wps=17612.5, ups=22.78, wpb=773, bsz=19.2, num_updates=1960, lr=0.000245, gnorm=1.512, loss_scale=64, train_wall=0, wall=140
2024-12-12 04:53:57 | INFO | train_inner | epoch 001:   1971 / 145082 loss=9.843, nll_loss=8.959, ppl=497.61, wps=18498.4, ups=23.55, wpb=785.6, bsz=34.4, num_updates=1970, lr=0.00024625, gnorm=1.475, loss_scale=64, train_wall=0, wall=141
2024-12-12 04:53:58 | INFO | train_inner | epoch 001:   1981 / 145082 loss=10.154, nll_loss=9.314, ppl=636.51, wps=18992, ups=22.48, wpb=844.7, bsz=33.6, num_updates=1980, lr=0.0002475, gnorm=1.829, loss_scale=64, train_wall=0, wall=141
2024-12-12 04:53:58 | INFO | train_inner | epoch 001:   1991 / 145082 loss=10.196, nll_loss=9.36, ppl=657.02, wps=19173, ups=22.79, wpb=841.2, bsz=24.5, num_updates=1990, lr=0.00024875, gnorm=1.478, loss_scale=64, train_wall=0, wall=141
2024-12-12 04:53:59 | INFO | train_inner | epoch 001:   2001 / 145082 loss=10.106, nll_loss=9.256, ppl=611.45, wps=17868.4, ups=23.29, wpb=767.1, bsz=24, num_updates=2000, lr=0.00025, gnorm=1.51, loss_scale=64, train_wall=0, wall=142
2024-12-12 04:53:59 | INFO | train_inner | epoch 001:   2011 / 145082 loss=10.243, nll_loss=9.418, ppl=684.11, wps=18468.4, ups=23.87, wpb=773.6, bsz=26.4, num_updates=2010, lr=0.00025125, gnorm=1.484, loss_scale=64, train_wall=0, wall=142
2024-12-12 04:53:59 | INFO | train_inner | epoch 001:   2021 / 145082 loss=10.176, nll_loss=9.338, ppl=647.16, wps=20709.7, ups=24.79, wpb=835.4, bsz=20.8, num_updates=2020, lr=0.0002525, gnorm=1.358, loss_scale=64, train_wall=0, wall=143
2024-12-12 04:54:00 | INFO | train_inner | epoch 001:   2031 / 145082 loss=10.027, nll_loss=9.168, ppl=575.18, wps=19547, ups=24.91, wpb=784.8, bsz=25.6, num_updates=2030, lr=0.00025375, gnorm=1.468, loss_scale=64, train_wall=0, wall=143
2024-12-12 04:54:00 | INFO | train_inner | epoch 001:   2041 / 145082 loss=10.115, nll_loss=9.278, ppl=620.84, wps=20771.1, ups=24, wpb=865.6, bsz=28, num_updates=2040, lr=0.000255, gnorm=1.464, loss_scale=64, train_wall=0, wall=144
2024-12-12 04:54:01 | INFO | train_inner | epoch 001:   2051 / 145082 loss=9.975, nll_loss=9.109, ppl=552.02, wps=20263.5, ups=23.94, wpb=846.4, bsz=30.4, num_updates=2050, lr=0.00025625, gnorm=1.359, loss_scale=64, train_wall=0, wall=144
2024-12-12 04:54:01 | INFO | train_inner | epoch 001:   2061 / 145082 loss=10.071, nll_loss=9.226, ppl=598.78, wps=20370.5, ups=24.65, wpb=826.3, bsz=21.6, num_updates=2060, lr=0.0002575, gnorm=1.428, loss_scale=64, train_wall=0, wall=144
2024-12-12 04:54:01 | INFO | train_inner | epoch 001:   2071 / 145082 loss=9.939, nll_loss=9.068, ppl=536.55, wps=19651, ups=25.18, wpb=780.3, bsz=20.8, num_updates=2070, lr=0.00025875, gnorm=1.375, loss_scale=64, train_wall=0, wall=145
2024-12-12 04:54:02 | INFO | train_inner | epoch 001:   2081 / 145082 loss=10.219, nll_loss=9.392, ppl=671.99, wps=19681.1, ups=24.23, wpb=812.2, bsz=22.4, num_updates=2080, lr=0.00026, gnorm=1.46, loss_scale=64, train_wall=0, wall=145
2024-12-12 04:54:02 | INFO | train_inner | epoch 001:   2091 / 145082 loss=9.835, nll_loss=8.947, ppl=493.59, wps=19350.9, ups=23.36, wpb=828.2, bsz=27.2, num_updates=2090, lr=0.00026125, gnorm=1.503, loss_scale=64, train_wall=0, wall=146
2024-12-12 04:54:03 | INFO | train_inner | epoch 001:   2101 / 145082 loss=9.89, nll_loss=9.024, ppl=520.76, wps=19071.5, ups=23.98, wpb=795.2, bsz=29.6, num_updates=2100, lr=0.0002625, gnorm=1.568, loss_scale=64, train_wall=0, wall=146
2024-12-12 04:54:03 | INFO | train_inner | epoch 001:   2111 / 145082 loss=9.935, nll_loss=9.057, ppl=532.68, wps=19980.5, ups=24.27, wpb=823.3, bsz=24.8, num_updates=2110, lr=0.00026375, gnorm=1.436, loss_scale=64, train_wall=0, wall=146
2024-12-12 04:54:03 | INFO | train_inner | epoch 001:   2121 / 145082 loss=10.237, nll_loss=9.41, ppl=680.33, wps=20020.3, ups=24.02, wpb=833.6, bsz=24.8, num_updates=2120, lr=0.000265, gnorm=1.526, loss_scale=64, train_wall=0, wall=147
2024-12-12 04:54:04 | INFO | train_inner | epoch 001:   2131 / 145082 loss=10.223, nll_loss=9.394, ppl=672.85, wps=18933.7, ups=24.36, wpb=777.3, bsz=26.2, num_updates=2130, lr=0.00026625, gnorm=1.484, loss_scale=64, train_wall=0, wall=147
2024-12-12 04:54:04 | INFO | train_inner | epoch 001:   2141 / 145082 loss=10.122, nll_loss=9.282, ppl=622.41, wps=19685.5, ups=25.08, wpb=784.8, bsz=23.2, num_updates=2140, lr=0.0002675, gnorm=1.469, loss_scale=64, train_wall=0, wall=148
2024-12-12 04:54:05 | INFO | train_inner | epoch 001:   2151 / 145082 loss=9.897, nll_loss=9.02, ppl=519.3, wps=19958.7, ups=24.41, wpb=817.6, bsz=24.8, num_updates=2150, lr=0.00026875, gnorm=1.415, loss_scale=64, train_wall=0, wall=148
2024-12-12 04:54:05 | INFO | train_inner | epoch 001:   2161 / 145082 loss=9.818, nll_loss=8.927, ppl=486.69, wps=20140.1, ups=24.95, wpb=807.2, bsz=29.6, num_updates=2160, lr=0.00027, gnorm=1.582, loss_scale=64, train_wall=0, wall=148
2024-12-12 04:54:06 | INFO | train_inner | epoch 001:   2171 / 145082 loss=9.952, nll_loss=9.086, ppl=543.49, wps=20324.7, ups=24.59, wpb=826.4, bsz=22.4, num_updates=2170, lr=0.00027125, gnorm=1.454, loss_scale=64, train_wall=0, wall=149
2024-12-12 04:54:06 | INFO | train_inner | epoch 001:   2181 / 145082 loss=10.046, nll_loss=9.184, ppl=581.64, wps=18438.7, ups=24.96, wpb=738.6, bsz=22, num_updates=2180, lr=0.0002725, gnorm=1.633, loss_scale=64, train_wall=0, wall=149
2024-12-12 04:54:06 | INFO | train_inner | epoch 001:   2191 / 145082 loss=9.944, nll_loss=9.086, ppl=543.63, wps=21175.9, ups=23.89, wpb=886.4, bsz=32, num_updates=2190, lr=0.00027375, gnorm=1.417, loss_scale=64, train_wall=0, wall=150
2024-12-12 04:54:07 | INFO | train_inner | epoch 001:   2201 / 145082 loss=9.944, nll_loss=9.068, ppl=536.58, wps=20001.7, ups=25.18, wpb=794.2, bsz=20.8, num_updates=2200, lr=0.000275, gnorm=1.522, loss_scale=64, train_wall=0, wall=150
2024-12-12 04:54:07 | INFO | train_inner | epoch 001:   2211 / 145082 loss=9.956, nll_loss=9.09, ppl=544.97, wps=19817.1, ups=24.5, wpb=808.9, bsz=24.8, num_updates=2210, lr=0.00027625, gnorm=1.477, loss_scale=64, train_wall=0, wall=150
2024-12-12 04:54:08 | INFO | train_inner | epoch 001:   2221 / 145082 loss=9.839, nll_loss=8.957, ppl=496.89, wps=19568.3, ups=24.41, wpb=801.6, bsz=29.6, num_updates=2220, lr=0.0002775, gnorm=1.559, loss_scale=64, train_wall=0, wall=151
2024-12-12 04:54:08 | INFO | train_inner | epoch 001:   2231 / 145082 loss=9.751, nll_loss=8.861, ppl=465.11, wps=18706, ups=24.82, wpb=753.6, bsz=26.4, num_updates=2230, lr=0.00027875, gnorm=1.532, loss_scale=64, train_wall=0, wall=151
2024-12-12 04:54:08 | INFO | train_inner | epoch 001:   2241 / 145082 loss=9.77, nll_loss=8.878, ppl=470.55, wps=17595.7, ups=25.82, wpb=681.4, bsz=24.8, num_updates=2240, lr=0.00028, gnorm=1.629, loss_scale=64, train_wall=0, wall=152
2024-12-12 04:54:09 | INFO | train_inner | epoch 001:   2251 / 145082 loss=9.677, nll_loss=8.767, ppl=435.7, wps=19325.9, ups=24.55, wpb=787.2, bsz=31.2, num_updates=2250, lr=0.00028125, gnorm=1.469, loss_scale=64, train_wall=0, wall=152
2024-12-12 04:54:09 | INFO | train_inner | epoch 001:   2261 / 145082 loss=9.75, nll_loss=8.862, ppl=465.41, wps=21515.2, ups=23.43, wpb=918.4, bsz=37.6, num_updates=2260, lr=0.0002825, gnorm=1.49, loss_scale=64, train_wall=0, wall=153
2024-12-12 04:54:10 | INFO | train_inner | epoch 001:   2271 / 145082 loss=9.868, nll_loss=8.982, ppl=505.61, wps=19027.4, ups=24.9, wpb=764, bsz=25.6, num_updates=2270, lr=0.00028375, gnorm=1.582, loss_scale=64, train_wall=0, wall=153
2024-12-12 04:54:10 | INFO | train_inner | epoch 001:   2281 / 145082 loss=9.968, nll_loss=9.105, ppl=550.71, wps=18580.8, ups=25.16, wpb=738.4, bsz=25.6, num_updates=2280, lr=0.000285, gnorm=1.575, loss_scale=64, train_wall=0, wall=153
2024-12-12 04:54:10 | INFO | train_inner | epoch 001:   2291 / 145082 loss=9.827, nll_loss=8.94, ppl=491.23, wps=18948.6, ups=25.22, wpb=751.2, bsz=20, num_updates=2290, lr=0.00028625, gnorm=1.412, loss_scale=64, train_wall=0, wall=154
2024-12-12 04:54:11 | INFO | train_inner | epoch 001:   2301 / 145082 loss=9.844, nll_loss=8.961, ppl=498.24, wps=19550.3, ups=24.92, wpb=784.4, bsz=25.6, num_updates=2300, lr=0.0002875, gnorm=1.556, loss_scale=64, train_wall=0, wall=154
2024-12-12 04:54:11 | INFO | train_inner | epoch 001:   2311 / 145082 loss=9.547, nll_loss=8.623, ppl=394.19, wps=20955.4, ups=24.76, wpb=846.4, bsz=36.8, num_updates=2310, lr=0.00028875, gnorm=1.501, loss_scale=64, train_wall=0, wall=155
2024-12-12 04:54:12 | INFO | train_inner | epoch 001:   2321 / 145082 loss=9.785, nll_loss=8.896, ppl=476.39, wps=17914.1, ups=25.05, wpb=715.1, bsz=26.4, num_updates=2320, lr=0.00029, gnorm=1.566, loss_scale=64, train_wall=0, wall=155
2024-12-12 04:54:12 | INFO | train_inner | epoch 001:   2331 / 145082 loss=9.789, nll_loss=8.908, ppl=480.53, wps=20807.5, ups=24.43, wpb=851.8, bsz=32.8, num_updates=2330, lr=0.00029125, gnorm=1.45, loss_scale=64, train_wall=0, wall=155
2024-12-12 04:54:12 | INFO | train_inner | epoch 001:   2341 / 145082 loss=9.898, nll_loss=9.02, ppl=519.16, wps=20565.4, ups=24.96, wpb=824, bsz=27.2, num_updates=2340, lr=0.0002925, gnorm=1.44, loss_scale=64, train_wall=0, wall=156
2024-12-12 04:54:13 | INFO | train_inner | epoch 001:   2351 / 145082 loss=9.891, nll_loss=9.015, ppl=517.52, wps=20242, ups=24.55, wpb=824.5, bsz=28.8, num_updates=2350, lr=0.00029375, gnorm=1.431, loss_scale=64, train_wall=0, wall=156
2024-12-12 04:54:13 | INFO | train_inner | epoch 001:   2361 / 145082 loss=9.847, nll_loss=8.974, ppl=502.96, wps=18546, ups=24.95, wpb=743.2, bsz=20, num_updates=2360, lr=0.000295, gnorm=1.481, loss_scale=64, train_wall=0, wall=157
2024-12-12 04:54:14 | INFO | train_inner | epoch 001:   2371 / 145082 loss=9.76, nll_loss=8.862, ppl=465.32, wps=20654.4, ups=24.2, wpb=853.6, bsz=25.6, num_updates=2370, lr=0.00029625, gnorm=1.351, loss_scale=64, train_wall=0, wall=157
2024-12-12 04:54:14 | INFO | train_inner | epoch 001:   2381 / 145082 loss=9.935, nll_loss=9.071, ppl=537.89, wps=19915.5, ups=24.22, wpb=822.4, bsz=20, num_updates=2380, lr=0.0002975, gnorm=1.345, loss_scale=64, train_wall=0, wall=157
2024-12-12 04:54:14 | INFO | train_inner | epoch 001:   2391 / 145082 loss=9.78, nll_loss=8.888, ppl=473.65, wps=20105.7, ups=24.21, wpb=830.6, bsz=30.1, num_updates=2390, lr=0.00029875, gnorm=1.623, loss_scale=64, train_wall=0, wall=158
2024-12-12 04:54:15 | INFO | train_inner | epoch 001:   2401 / 145082 loss=9.48, nll_loss=8.552, ppl=375.25, wps=20066.6, ups=24.45, wpb=820.8, bsz=36, num_updates=2400, lr=0.0003, gnorm=1.564, loss_scale=64, train_wall=0, wall=158
2024-12-12 04:54:15 | INFO | train_inner | epoch 001:   2411 / 145082 loss=9.788, nll_loss=8.903, ppl=478.81, wps=21808.6, ups=23.42, wpb=931.2, bsz=30.4, num_updates=2410, lr=0.00030125, gnorm=1.417, loss_scale=64, train_wall=0, wall=159
2024-12-12 04:54:16 | INFO | train_inner | epoch 001:   2421 / 145082 loss=9.741, nll_loss=8.841, ppl=458.43, wps=21014.8, ups=24.08, wpb=872.8, bsz=30.4, num_updates=2420, lr=0.0003025, gnorm=1.412, loss_scale=64, train_wall=0, wall=159
2024-12-12 04:54:16 | INFO | train_inner | epoch 001:   2431 / 145082 loss=9.538, nll_loss=8.615, ppl=392.2, wps=20229.7, ups=23.86, wpb=848, bsz=39.2, num_updates=2430, lr=0.00030375, gnorm=1.46, loss_scale=64, train_wall=0, wall=159
2024-12-12 04:54:17 | INFO | train_inner | epoch 001:   2441 / 145082 loss=9.737, nll_loss=8.838, ppl=457.56, wps=20407.1, ups=23.88, wpb=854.4, bsz=31.2, num_updates=2440, lr=0.000305, gnorm=1.383, loss_scale=64, train_wall=0, wall=160
2024-12-12 04:54:17 | INFO | train_inner | epoch 001:   2451 / 145082 loss=9.95, nll_loss=9.085, ppl=543.14, wps=18661.1, ups=25.24, wpb=739.2, bsz=16.8, num_updates=2450, lr=0.00030625, gnorm=1.517, loss_scale=64, train_wall=0, wall=160
2024-12-12 04:54:17 | INFO | train_inner | epoch 001:   2461 / 145082 loss=9.791, nll_loss=8.899, ppl=477.26, wps=20324.1, ups=23.96, wpb=848.2, bsz=29.6, num_updates=2460, lr=0.0003075, gnorm=1.495, loss_scale=64, train_wall=0, wall=161
2024-12-12 04:54:18 | INFO | train_inner | epoch 001:   2471 / 145082 loss=9.865, nll_loss=8.992, ppl=509.08, wps=20063.4, ups=25.04, wpb=801.1, bsz=24, num_updates=2470, lr=0.00030875, gnorm=1.384, loss_scale=64, train_wall=0, wall=161
2024-12-12 04:54:18 | INFO | train_inner | epoch 001:   2481 / 145082 loss=9.484, nll_loss=8.55, ppl=374.84, wps=21157.7, ups=24.2, wpb=874.4, bsz=32, num_updates=2480, lr=0.00031, gnorm=1.401, loss_scale=64, train_wall=0, wall=162
2024-12-12 04:54:19 | INFO | train_inner | epoch 001:   2491 / 145082 loss=9.893, nll_loss=9.023, ppl=520.07, wps=19112.5, ups=25.02, wpb=764, bsz=20.8, num_updates=2490, lr=0.00031125, gnorm=1.482, loss_scale=64, train_wall=0, wall=162
2024-12-12 04:54:19 | INFO | train_inner | epoch 001:   2501 / 145082 loss=9.723, nll_loss=8.826, ppl=453.74, wps=20525.4, ups=24.46, wpb=839.2, bsz=24.8, num_updates=2500, lr=0.0003125, gnorm=1.414, loss_scale=64, train_wall=0, wall=162
2024-12-12 04:54:19 | INFO | train_inner | epoch 001:   2511 / 145082 loss=9.885, nll_loss=9.008, ppl=514.76, wps=19178.8, ups=25.61, wpb=748.8, bsz=22.4, num_updates=2510, lr=0.00031375, gnorm=1.595, loss_scale=64, train_wall=0, wall=163
2024-12-12 04:54:20 | INFO | train_inner | epoch 001:   2521 / 145082 loss=9.613, nll_loss=8.702, ppl=416.49, wps=18761, ups=23.12, wpb=811.4, bsz=23.2, num_updates=2520, lr=0.000315, gnorm=1.37, loss_scale=64, train_wall=0, wall=163
2024-12-12 04:54:20 | INFO | train_inner | epoch 001:   2531 / 145082 loss=9.722, nll_loss=8.815, ppl=450.33, wps=20019.4, ups=24.32, wpb=823.2, bsz=22.4, num_updates=2530, lr=0.00031625, gnorm=1.394, loss_scale=64, train_wall=0, wall=164
2024-12-12 04:54:21 | INFO | train_inner | epoch 001:   2541 / 145082 loss=9.917, nll_loss=9.055, ppl=531.82, wps=20914.7, ups=24.43, wpb=856.1, bsz=21.6, num_updates=2540, lr=0.0003175, gnorm=1.378, loss_scale=64, train_wall=0, wall=164
2024-12-12 04:54:21 | INFO | train_inner | epoch 001:   2551 / 145082 loss=9.873, nll_loss=8.987, ppl=507.41, wps=20147.4, ups=24.43, wpb=824.8, bsz=24, num_updates=2550, lr=0.00031875, gnorm=1.524, loss_scale=64, train_wall=0, wall=164
2024-12-12 04:54:21 | INFO | train_inner | epoch 001:   2561 / 145082 loss=9.707, nll_loss=8.805, ppl=447.36, wps=20152.3, ups=25.07, wpb=803.9, bsz=22.4, num_updates=2560, lr=0.00032, gnorm=1.442, loss_scale=64, train_wall=0, wall=165
2024-12-12 04:54:22 | INFO | train_inner | epoch 001:   2571 / 145082 loss=9.726, nll_loss=8.83, ppl=455.17, wps=20881.8, ups=24.46, wpb=853.6, bsz=26.4, num_updates=2570, lr=0.00032125, gnorm=1.329, loss_scale=64, train_wall=0, wall=165
2024-12-12 04:54:22 | INFO | train_inner | epoch 001:   2581 / 145082 loss=9.546, nll_loss=8.629, ppl=395.96, wps=19569.8, ups=24.59, wpb=796, bsz=32, num_updates=2580, lr=0.0003225, gnorm=1.473, loss_scale=64, train_wall=0, wall=166
2024-12-12 04:54:23 | INFO | train_inner | epoch 001:   2591 / 145082 loss=9.727, nll_loss=8.833, ppl=456.05, wps=21308.2, ups=24.42, wpb=872.7, bsz=24.8, num_updates=2590, lr=0.00032375, gnorm=1.363, loss_scale=64, train_wall=0, wall=166
2024-12-12 04:54:23 | INFO | train_inner | epoch 001:   2601 / 145082 loss=9.507, nll_loss=8.568, ppl=379.63, wps=21392.1, ups=24.29, wpb=880.7, bsz=27.2, num_updates=2600, lr=0.000325, gnorm=1.385, loss_scale=64, train_wall=0, wall=166
2024-12-12 04:54:23 | INFO | train_inner | epoch 001:   2611 / 145082 loss=9.786, nll_loss=8.898, ppl=477.13, wps=20501.2, ups=24.24, wpb=845.6, bsz=23.2, num_updates=2610, lr=0.00032625, gnorm=1.416, loss_scale=64, train_wall=0, wall=167
2024-12-12 04:54:24 | INFO | train_inner | epoch 001:   2621 / 145082 loss=9.796, nll_loss=8.906, ppl=479.82, wps=19383.3, ups=25.2, wpb=769.1, bsz=15.9, num_updates=2620, lr=0.0003275, gnorm=1.508, loss_scale=64, train_wall=0, wall=167
2024-12-12 04:54:24 | INFO | train_inner | epoch 001:   2631 / 145082 loss=9.633, nll_loss=8.721, ppl=421.96, wps=18618.9, ups=25.13, wpb=741, bsz=27.2, num_updates=2630, lr=0.00032875, gnorm=1.562, loss_scale=64, train_wall=0, wall=168
2024-12-12 04:54:25 | INFO | train_inner | epoch 001:   2641 / 145082 loss=9.72, nll_loss=8.822, ppl=452.46, wps=19368.3, ups=26.17, wpb=740, bsz=20.8, num_updates=2640, lr=0.00033, gnorm=1.506, loss_scale=64, train_wall=0, wall=168
2024-12-12 04:54:25 | INFO | train_inner | epoch 001:   2651 / 145082 loss=9.761, nll_loss=8.86, ppl=464.76, wps=20009.3, ups=24.86, wpb=804.8, bsz=35.2, num_updates=2650, lr=0.00033125, gnorm=1.733, loss_scale=64, train_wall=0, wall=168
2024-12-12 04:54:25 | INFO | train_inner | epoch 001:   2661 / 145082 loss=9.864, nll_loss=8.983, ppl=505.93, wps=19080.8, ups=23.75, wpb=803.3, bsz=27.9, num_updates=2660, lr=0.0003325, gnorm=1.518, loss_scale=64, train_wall=0, wall=169
2024-12-12 04:54:26 | INFO | train_inner | epoch 001:   2671 / 145082 loss=9.745, nll_loss=8.85, ppl=461.32, wps=20975.2, ups=23.84, wpb=880, bsz=28, num_updates=2670, lr=0.00033375, gnorm=1.401, loss_scale=64, train_wall=0, wall=169
2024-12-12 04:54:26 | INFO | train_inner | epoch 001:   2681 / 145082 loss=9.667, nll_loss=8.771, ppl=436.87, wps=19584.1, ups=23.99, wpb=816.5, bsz=31.8, num_updates=2680, lr=0.000335, gnorm=1.505, loss_scale=64, train_wall=0, wall=170
2024-12-12 04:54:27 | INFO | train_inner | epoch 001:   2691 / 145082 loss=9.46, nll_loss=8.524, ppl=368.18, wps=21483.6, ups=23.79, wpb=903.2, bsz=34.4, num_updates=2690, lr=0.00033625, gnorm=1.375, loss_scale=64, train_wall=0, wall=170
2024-12-12 04:54:27 | INFO | train_inner | epoch 001:   2701 / 145082 loss=9.763, nll_loss=8.865, ppl=466.2, wps=18108.1, ups=25.16, wpb=719.6, bsz=16, num_updates=2700, lr=0.0003375, gnorm=1.499, loss_scale=64, train_wall=0, wall=170
2024-12-12 04:54:28 | INFO | train_inner | epoch 001:   2711 / 145082 loss=9.592, nll_loss=8.684, ppl=411.39, wps=19652.7, ups=25.14, wpb=781.6, bsz=31.2, num_updates=2710, lr=0.00033875, gnorm=1.62, loss_scale=64, train_wall=0, wall=171
2024-12-12 04:54:28 | INFO | train_inner | epoch 001:   2721 / 145082 loss=9.84, nll_loss=8.954, ppl=495.84, wps=19777.8, ups=24.57, wpb=804.8, bsz=25.6, num_updates=2720, lr=0.00034, gnorm=1.45, loss_scale=64, train_wall=0, wall=171
2024-12-12 04:54:28 | INFO | train_inner | epoch 001:   2731 / 145082 loss=9.729, nll_loss=8.84, ppl=458.21, wps=19888.3, ups=24.37, wpb=816, bsz=24.8, num_updates=2730, lr=0.00034125, gnorm=1.4, loss_scale=64, train_wall=0, wall=172
2024-12-12 04:54:29 | INFO | train_inner | epoch 001:   2741 / 145082 loss=9.618, nll_loss=8.704, ppl=417.02, wps=20240.8, ups=24, wpb=843.2, bsz=31.2, num_updates=2740, lr=0.0003425, gnorm=1.486, loss_scale=64, train_wall=0, wall=172
2024-12-12 04:54:29 | INFO | train_inner | epoch 001:   2751 / 145082 loss=9.775, nll_loss=8.891, ppl=474.86, wps=17502, ups=25.97, wpb=673.8, bsz=16, num_updates=2750, lr=0.00034375, gnorm=1.544, loss_scale=64, train_wall=0, wall=172
2024-12-12 04:54:30 | INFO | train_inner | epoch 001:   2761 / 145082 loss=9.622, nll_loss=8.707, ppl=417.89, wps=20200, ups=24.23, wpb=833.6, bsz=35.2, num_updates=2760, lr=0.000345, gnorm=1.632, loss_scale=64, train_wall=0, wall=173
2024-12-12 04:54:30 | INFO | train_inner | epoch 001:   2771 / 145082 loss=9.74, nll_loss=8.852, ppl=462.18, wps=20773.8, ups=24.09, wpb=862.4, bsz=32, num_updates=2770, lr=0.00034625, gnorm=1.504, loss_scale=64, train_wall=0, wall=173
2024-12-12 04:54:30 | INFO | train_inner | epoch 001:   2781 / 145082 loss=9.984, nll_loss=9.119, ppl=555.84, wps=18752.2, ups=25.23, wpb=743.2, bsz=18.4, num_updates=2780, lr=0.0003475, gnorm=1.541, loss_scale=64, train_wall=0, wall=174
2024-12-12 04:54:31 | INFO | train_inner | epoch 001:   2791 / 145082 loss=9.487, nll_loss=8.558, ppl=377.01, wps=20462.8, ups=24.24, wpb=844, bsz=23.2, num_updates=2790, lr=0.00034875, gnorm=1.341, loss_scale=64, train_wall=0, wall=174
2024-12-12 04:54:31 | INFO | train_inner | epoch 001:   2801 / 145082 loss=9.65, nll_loss=8.744, ppl=428.63, wps=19127.4, ups=25.71, wpb=744, bsz=18.4, num_updates=2800, lr=0.00035, gnorm=1.462, loss_scale=64, train_wall=0, wall=175
2024-12-12 04:54:32 | INFO | train_inner | epoch 001:   2811 / 145082 loss=9.773, nll_loss=8.88, ppl=471.07, wps=19788.9, ups=25.21, wpb=785, bsz=22.4, num_updates=2810, lr=0.00035125, gnorm=1.489, loss_scale=64, train_wall=0, wall=175
2024-12-12 04:54:32 | INFO | train_inner | epoch 001:   2821 / 145082 loss=9.914, nll_loss=9.037, ppl=525.15, wps=18907, ups=25.33, wpb=746.4, bsz=16.8, num_updates=2820, lr=0.0003525, gnorm=1.471, loss_scale=64, train_wall=0, wall=175
2024-12-12 04:54:32 | INFO | train_inner | epoch 001:   2831 / 145082 loss=9.633, nll_loss=8.727, ppl=423.71, wps=20030.5, ups=24.57, wpb=815.2, bsz=25.6, num_updates=2830, lr=0.00035375, gnorm=1.425, loss_scale=64, train_wall=0, wall=176
2024-12-12 04:54:33 | INFO | train_inner | epoch 001:   2841 / 145082 loss=9.755, nll_loss=8.859, ppl=464.41, wps=18998.4, ups=25.6, wpb=742.2, bsz=18.4, num_updates=2840, lr=0.000355, gnorm=1.483, loss_scale=64, train_wall=0, wall=176
2024-12-12 04:54:33 | INFO | train_inner | epoch 001:   2851 / 145082 loss=9.482, nll_loss=8.551, ppl=375.01, wps=19980.1, ups=24.61, wpb=812, bsz=32, num_updates=2850, lr=0.00035625, gnorm=1.516, loss_scale=64, train_wall=0, wall=177
2024-12-12 04:54:34 | INFO | train_inner | epoch 001:   2861 / 145082 loss=9.521, nll_loss=8.598, ppl=387.59, wps=20347.4, ups=24.41, wpb=833.6, bsz=24.8, num_updates=2860, lr=0.0003575, gnorm=1.312, loss_scale=64, train_wall=0, wall=177
2024-12-12 04:54:34 | INFO | train_inner | epoch 001:   2871 / 145082 loss=9.635, nll_loss=8.719, ppl=421.4, wps=19665.7, ups=24.98, wpb=787.2, bsz=20.8, num_updates=2870, lr=0.00035875, gnorm=1.466, loss_scale=64, train_wall=0, wall=177
2024-12-12 04:54:34 | INFO | train_inner | epoch 001:   2881 / 145082 loss=9.511, nll_loss=8.596, ppl=386.92, wps=20387.7, ups=24.26, wpb=840.5, bsz=28.8, num_updates=2880, lr=0.00036, gnorm=1.397, loss_scale=64, train_wall=0, wall=178
2024-12-12 04:54:35 | INFO | train_inner | epoch 001:   2891 / 145082 loss=9.74, nll_loss=8.832, ppl=455.66, wps=21009.9, ups=24.99, wpb=840.8, bsz=24, num_updates=2890, lr=0.00036125, gnorm=1.471, loss_scale=64, train_wall=0, wall=178
2024-12-12 04:54:35 | INFO | train_inner | epoch 001:   2901 / 145082 loss=9.739, nll_loss=8.849, ppl=461.12, wps=20402, ups=24.57, wpb=830.4, bsz=24.8, num_updates=2900, lr=0.0003625, gnorm=1.451, loss_scale=64, train_wall=0, wall=179
2024-12-12 04:54:36 | INFO | train_inner | epoch 001:   2911 / 145082 loss=9.585, nll_loss=8.665, ppl=405.88, wps=20149.9, ups=23.92, wpb=842.4, bsz=27.2, num_updates=2910, lr=0.00036375, gnorm=1.369, loss_scale=64, train_wall=0, wall=179
2024-12-12 04:54:36 | INFO | train_inner | epoch 001:   2921 / 145082 loss=9.504, nll_loss=8.573, ppl=380.94, wps=20754.1, ups=24.43, wpb=849.6, bsz=29.6, num_updates=2920, lr=0.000365, gnorm=1.388, loss_scale=64, train_wall=0, wall=179
2024-12-12 04:54:36 | INFO | train_inner | epoch 001:   2931 / 145082 loss=9.601, nll_loss=8.685, ppl=411.66, wps=19435.9, ups=24.15, wpb=804.8, bsz=25.6, num_updates=2930, lr=0.00036625, gnorm=1.504, loss_scale=64, train_wall=0, wall=180
2024-12-12 04:54:37 | INFO | fairseq_cli.train | begin save checkpoint
2024-12-12 04:54:41 | INFO | fairseq.checkpoint_utils | saved checkpoint checkpoints/checkpoint_last.pt (epoch 1 @ 2936 updates, score None) (writing took 4.395744439999817 seconds)
2024-12-12 04:54:41 | INFO | fairseq_cli.train | end of epoch 1 (average epoch stats below)
2024-12-12 04:54:41 | INFO | train | epoch 001 | loss 10.846 | nll_loss 10.092 | ppl 1091.05 | wps 18863.2 | ups 23.36 | wpb 807.5 | bsz 26.6 | num_updates 2936 | lr 0.000367 | gnorm 1.752 | loss_scale 64 | train_wall 119 | wall 184
2024-12-12 04:54:41 | INFO | fairseq_cli.train | done training in 125.8 seconds
